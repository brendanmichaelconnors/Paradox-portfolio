library(MASS)#
library(ggplot2)#
library(gridExtra)#
#
# -----------------------------------------------------------------------------#
# Panel plot for sockey systems#
# -----------------------------------------------------------------------------#
#
systems <- c("Bristol Bay", "Fraser", "Skeena")#
decades <- c("1970s", "1980s", "1990s", "2000s")#
System.all <- list()#
#
yr.range <- 10#
for(j in 1:length(systems)) {#
  temp.S <- read.csv(paste(systems[j], "_Smsy_", yr.range, "yrs.csv", sep=""), header=T)#
  colnames(temp.S) <- c("lake", "meanSmsy", "SlowerCI", "SupperCI",#
                        "S1970s", "S1980s", "S1990s", "S2000s", "SAll")#
  temp.U <- read.csv(paste(systems[j], "_Umsy_", yr.range, "yrs.csv", sep=""), header=T)#
  for(i in 1:length(decades)) {#
    S.msy.temp <- cbind(temp.S[(4+i)]/temp.S$meanSmsy,#
                        temp.S[(4+i)]/temp.S$SlowerCI,#
                        temp.S[(4+i)]/temp.S$SupperCI)#
    colnames(S.msy.temp) <- c(paste("S_Smsy_", decades[i], sep=""),#
                               paste("SLCL_", decades[i], sep=""),#
                               paste("SUCL_", decades[i], sep=""))#
    temp.S <- cbind(temp.S, S.msy.temp)#
#
    U.msy.temp <- cbind(temp.U[(4+i)]/temp.U$meanUmsy,#
                        temp.U[(4+i)]/(temp.U$lowerCI),#
                        temp.U[(4+i)]/(temp.U$upperCI))#
    colnames(U.msy.temp) <- c(paste("U_Umsy_", decades[i], sep=""),#
                              paste("ULCL_", decades[i], sep=""),#
                              paste("UUCL_", decades[i], sep=""))#
    temp.U <- cbind(temp.U, U.msy.temp)#
#
    sys.name <- rep(systems[j], nrow(temp.U))#
  }#
#
  System.all[[j]] <- cbind(system=sys.name, temp.S, temp.U)#
#
}#
#
all.dat <- do.call(rbind.data.frame, System.all)
# -----------------------------------------------------------------------------#
# Kernel density plots -- 12 panel plot#
# -----------------------------------------------------------------------------#
#
bandwidth = c(0.8,.8)#
# bandwidth feels super arbitrary -- where it basically sets how tight the #
# contours are around the points, the first one sets in the x direction and the#
# second in the y direction (though they seem to interact)... as soon as the #
# first element jumps to 0.9, we start to get the weird splits in the Skeena#
# 2000s plot... c(0.8, 1) seems to be the closest to what we had before, but#
# without the overstretching in the Skeena plot...#
# CHANGE: since we reduced the y axis from c(0,4) to c(0,2.5) this changed#
# to c(0.8, 0.8)#
#
#############
### BBay ####
#############
dat = all.dat[all.dat$system==systems[1],]#
colors <- colorRampPalette(c("white", "#458B74", "#2F4F4F"))(10)#
p1 <- ggplot(data = dat) +#
  stat_density_2d(aes(x=S_Smsy_1980s, y=U_Umsy_1980s, fill = stat(level)), geom="polygon", h=bandwidth) +#
  scale_fill_distiller(palette=12, direction=1) +#
  scale_x_continuous("",limits = c(0,4),labels=rep("",5))+#
  scale_y_continuous(name=bquote(" U/ "* U[MSY]), limits = c(0,2.5)) +#
  geom_vline(xintercept=1) +#
  geom_hline(yintercept=1) +#
  geom_point(aes(x=S_Smsy_1980s, y=U_Umsy_1980s), size=2.5,alpha=0.45,shape=16) +#
  theme_bw() +#
  theme(panel.background = element_blank(),panel.grid = element_blank(), #
        plot.margin = unit(c(0,0.2,0.2,0), "lines"), legend.position="none",#
        panel.border = element_rect(colour = "black", fill=NA, size=1.5)) +#
  annotate("text", x=0.2, y=2.5, label= "1980s",size=5) +#
  annotate("text", x=4, y=2.5, label="A", size=6)#
#
p2 <- ggplot(data = dat) +#
  stat_density_2d(aes(x=S_Smsy_2000s, y=U_Umsy_2000s, fill = stat(level)), geom="polygon", h=bandwidth) +#
  scale_fill_distiller(palette=12, direction=1) +#
  geom_point(aes(S_Smsy_2000s, U_Umsy_2000s), size=2.5,alpha=0.45,shape=16) +#
  scale_x_continuous("",limits = c(0,4),labels=rep("",5))+#
  scale_y_continuous("",limits = c(0,2.5),labels = NULL)+#
  geom_vline(xintercept=1)+#
  geom_hline(yintercept=1)+#
  theme_bw()+#
  theme(panel.background = element_blank(),panel.grid = element_blank(), #
        plot.margin = unit(c(0,0.2,0.2,0), "lines"), legend.position="none",#
        panel.border = element_rect(colour = "black", fill=NA, size=1.5)) +#
  annotate("text", x=0.2, y=2.5,   label= "2000s",size=5)+#
  annotate("text", x=2.5, y=2.5,   label= "Bristol Bay",size=5)+#
  annotate("text", x=4, y=2.5, label="B", size=6)#
p3 <- ggplot(data=dat) +#
  geom_density(aes(x=S_Smsy_1980s, group=system,fill=system),alpha=0.65, adjust=3, linetype="dashed")+ #
  geom_density(aes(x=S_Smsy_2000s, group=system,fill=system),alpha=0.45, adjust=3)+ #
  scale_fill_manual(values=c("#5D478B"))+#
  scale_x_continuous(limits = c(0,4))+#
  coord_cartesian(ylim=c(0,1.2))+#
  theme(panel.background = element_blank(),axis.text = element_blank(), #
        axis.ticks=element_blank(),axis.title=element_blank())+#
  theme(legend.position="none",plot.margin = unit(c(0,0.2,2,.2), "lines"))+#
  geom_vline(xintercept=1) +#
  annotate("text", x=3, y=0.7, label= "S/Smsy", size=4)+#
  annotate("text", x=4, y=1.1, label="D", size=6)#
#
p4 <- ggplot(data=dat) +#
  geom_density(aes(x=U_Umsy_1980s, group=system,fill=system),alpha=0.65, adjust=3, linetype="dashed")+ #
  geom_density(aes(x=U_Umsy_2000s, group=system,fill=system),alpha=0.45, adjust=3)+ #
  scale_fill_manual(values=c("#5D478B"))+#
  coord_flip(ylim=c(0,1.5))+#
  # coord_cartesian()+#
  scale_x_continuous(name=bquote(" U/ "* U[MSY]),limits = c(0,2.5)) +#
  theme(panel.background = element_blank(),axis.text = element_blank(), #
        axis.ticks=element_blank(),axis.title=element_blank())+#
  theme(legend.position="none",plot.margin = unit(c(0,0.2,2,.2), "lines"))+#
  geom_vline(xintercept=1) +#
  annotate("text", x=2, y=1.2, label= "U/Umsy", size=4)+#
  annotate("text", x=2.3, y=1.5, label="C", size=6)#
###############
### Skeena ####
###############
dat = all.dat[all.dat$system==systems[3],]#
#
p9 <- ggplot(data = dat) +#
  stat_density_2d(aes(x=S_Smsy_1980s, y=U_Umsy_1980s, fill = stat(level)), geom = "polygon", h=bandwidth) +#
  scale_fill_distiller(palette=2, direction=1) +#
  geom_point(aes(S_Smsy_1980s, U_Umsy_1980s), size=2.5,alpha=0.45, shape=16) +#
  scale_x_continuous("",limits = c(0,4),labels=rep("",5))+#
  scale_y_continuous(name=bquote(" U/ "* U[MSY]),limits = c(0,2.5))+#
  geom_vline(xintercept=1)+#
  geom_hline(yintercept=1)+#
  theme_bw()+#
  theme(panel.background = element_blank(),panel.grid = element_blank(), #
        plot.margin = unit(c(0,0.2,0.2,0), "lines"), legend.position="none",#
        panel.border = element_rect(colour = "black", fill=NA, size=1.5)) +#
  annotate("text", x=4, y=2.5, label="E", size=6)#
#
p10 <- ggplot(data = dat) +#
  stat_density_2d(aes(x=S_Smsy_2000s, y=U_Umsy_2000s, fill = stat(level)), geom = "polygon", h=bandwidth) +#
  scale_fill_distiller(palette=2, direction=1) +#
  geom_point(aes(S_Smsy_2000s, U_Umsy_2000s), size=2.5,alpha=0.45,shape=16) +#
  scale_x_continuous("",limits = c(0,4),labels=rep("",5))+#
  scale_y_continuous("",limits = c(0,2.5),labels = NULL)+#
  geom_vline(xintercept=1)+#
  geom_hline(yintercept=1)+#
  theme_bw()+#
  theme(panel.background = element_blank(),panel.grid = element_blank(), #
        plot.margin = unit(c(0,0.2,0.2,0), "lines"), legend.position="none",#
        panel.border = element_rect(colour = "black", fill=NA, size=1.5)) +#
  annotate("text", x=2.5, y=2.5,   label= "Skeena River",size=5)+#
  annotate("text", x=4, y=2.5, label="F", size=6)#
#
p11 <- ggplot(data=dat) +#
  geom_density(aes(x=S_Smsy_1980s, group=system,fill=system),alpha=0.65, adjust=3, linetype="dashed")+ #
  geom_density(aes(x=S_Smsy_2000s, group=system,fill=system),alpha=0.45, adjust=3)+ #
  scale_fill_manual(values=c("#2E8B57"))+#
  scale_x_continuous(name=bquote(" S/"* S[MSY]),limits = c(0,4),position = "bottom") +#
  #scale_x_continuous(limits = c(0,4))+#
  coord_cartesian(ylim=c(0,1.2))+#
  theme(panel.background = element_blank(),axis.text = element_blank(), #
        axis.ticks=element_blank(),axis.title=element_blank())+#
  theme(legend.position="none",plot.margin = unit(c(0,0.2,2,.2), "lines"))+#
  geom_vline(xintercept=1)+#
  # annotate("text", x=3, y=0.7, label= "S/Smsy", size=4)+#
  annotate("text", x=4, y=1.1, label="H", size=6)#
#
p12 <- ggplot(data=dat) +#
  geom_density(aes(x=U_Umsy_1980s, group=system,fill=system),alpha=0.65, adjust=3, linetype="dashed")+ #
  geom_density(aes(x=U_Umsy_2000s, group=system,fill=system),alpha=0.45, adjust=3)+ #
  scale_fill_manual(values=c("#2E8B57"))+#
  coord_flip(ylim=c(0,1.5))+#
  # coord_cartesian(ylim=c(0,1.2))+#
  scale_x_continuous(limits = c(0,2.5))+#
  theme(panel.background = element_blank(),axis.text = element_blank(), #
        axis.ticks=element_blank(),axis.title=element_blank())+#
  theme(legend.position="none",plot.margin = unit(c(0,0.2,2,.2), "lines"))+#
  geom_vline(xintercept=1) +#
  # annotate("text", x=2, y=1.2, label= "U/Umsy", size=4)+#
  annotate("text", x=2.3, y=1.5, label="G", size=6)#
###############
### Fraser ####
###############
dat = all.dat[all.dat$system==systems[2],]#
#
p5 <- ggplot(data = dat) +#
  stat_density_2d(aes(x=S_Smsy_1980s, y=U_Umsy_1980s, fill = stat(level)), geom="polygon", h=bandwidth) +#
  scale_fill_distiller(palette=1, direction=1) +#
  geom_point(aes(S_Smsy_1980s, U_Umsy_1980s), size=2.5,alpha=0.45,shape=16) +#
  scale_x_continuous(name=bquote(" S/"* S[MSY]),limits = c(0,4), position = "bottom")+#
  scale_y_continuous(name=bquote(" U/ "* U[MSY]),limits = c(0,2.5))+#
  geom_vline(xintercept=1)+#
  geom_hline(yintercept=1)+#
  theme_bw()+#
  theme(panel.background = element_blank(),panel.grid = element_blank(), #
        plot.margin = unit(c(0,0.2,0.2,0), "lines"), legend.position="none",#
        panel.border = element_rect(colour = "black", fill=NA, size=1.5)) +#
  annotate("text", x=4, y=2.5, label="I", size=6)#
#
p6 <- ggplot(data = dat) +#
  stat_density_2d(aes(x=S_Smsy_2000s, y=U_Umsy_2000s, fill = stat(level)), geom="polygon", h=bandwidth) +#
  scale_fill_distiller(palette=1, direction=1) +#
  geom_point(aes(S_Smsy_2000s, U_Umsy_2000s), size=2.5,alpha=0.45,shape=16) +#
  scale_x_continuous(name=bquote(" S/"* S[MSY]),limits = c(0,4), position = "bottom")+#
  scale_y_continuous("",limits = c(0,2.5),labels = NULL)+#
  geom_vline(xintercept=1)+#
  geom_hline(yintercept=1)+#
  theme_bw()+#
  theme(panel.background = element_blank(),panel.grid = element_blank(), #
        plot.margin = unit(c(0,0.2,0.2,0), "lines"), legend.position="none",#
        panel.border = element_rect(colour = "black", fill=NA, size=1.5)) +#
  annotate("text", x=2.5, y=2.5,   label= "Fraser River",size=5)+#
  annotate("text", x=4, y=2.5, label="J", size=6)#
#
p7 <- ggplot(data=dat) +#
  geom_density(aes(x=S_Smsy_1980s, group=system,fill=system),alpha=0.65, adjust=3, linetype="dashed")+ #
  geom_density(aes(x=S_Smsy_2000s, group=system,fill=system),alpha=0.45, adjust=3)+ #
  scale_fill_manual(values=c("#104E8B"))+#
  scale_x_continuous(limits = c(0,4))+#
  coord_cartesian(ylim=c(0,1.2))+#
  theme(panel.background = element_blank(),axis.text = element_blank(), #
        axis.ticks=element_blank(),axis.title=element_blank())+#
  theme(legend.position="none",plot.margin = unit(c(0,0.2,2,.2), "lines"))+#
  geom_vline(xintercept=1) +#
  # annotate("text", x=3, y=0.7, label= "S/Smsy", size=4)+#
  annotate("text", x=4, y=1.1, label="L", size=6)#
p8 <- ggplot(data=dat) +#
  geom_density(aes(x=U_Umsy_1980s, group=system,fill=system),alpha=0.65, adjust=3, linetype="dashed")+ #
  geom_density(aes(x=U_Umsy_2000s, group=system,fill=system),alpha=0.45, adjust=3)+ #
  scale_fill_manual(values=c("#104E8B"))+#
  coord_flip(ylim=c(0,1.5))+#
  # coord_cartesian(ylim=c(0,1.2))+#
  scale_x_continuous(limits = c(0,2.5))+#
  theme(panel.background = element_blank(),axis.text = element_blank(), #
        axis.ticks=element_blank(),axis.title=element_blank())+#
  theme(legend.position="none",plot.margin = unit(c(0,0.2,2,.2), "lines"))+#
  geom_vline(xintercept=1) +#
  # annotate("text", x=2, y=1.2, label= "U/Umsy", size=4)+#
  annotate("text", x=2.3, y=1.5, label="K", size=6)#
# pdf("AllSystems_12panel.pdf", width=11, height=8)#
# grid.arrange(p1,p2,p3,p4,p5,p6,p7,p8,p9,p10,p11,p12,#
#              layout_matrix=rbind(c(1,2,3,4), c(5,6,7,8), c(9,10,11,12)))#
# dev.off()#
# #
# layout.mat <- matrix(c(1,1,2,2,3,NA,#
#                        1,1,2,2,NA,4,#
#                        5,5,6,6,7,NA,#
#                        5,5,6,6,NA,8,#
#                        9,9,10,10,11,NA,#
#                        9,9,10,10,NA,12), nrow=6, byrow=TRUE)#
#
layout.mat <- matrix(c(1,1,2,2,3,#
                       1,1,2,2,4,#
                       5,5,6,6,7,#
                       5,5,6,6,8,#
                       9,9,10,10,11,#
                       9,9,10,10,12), nrow=6, byrow=TRUE)
grid.arrange(p1,p2,p4,p3,p9,p10,p12,p11,p5,p6,p8,p7,#
             layout_matrix=layout.mat)
ggarrange(p1,p2,p4,p3,p9,p10,p12,p11,p5,p6,p8,p7)
library(ggpubr)#
#
ggarrange(p1,p2,p4,p3,p9,p10,p12,p11,p5,p6,p8,p7)
ggarrange(p1,p2,p4,p3,p9,p10,p12,p11,p5,p6,p8,p7, labels = c("A", "B", "C", "D", "E", "F", "G", "H"))
ggplot(data = dat) +#
  stat_density_2d(aes(x=S_Smsy_1980s, y=U_Umsy_1980s, fill = stat(level)), geom="polygon", h=bandwidth) +#
  scale_fill_distiller(palette=12, direction=1) +#
  scale_x_continuous("",limits = c(0,4),labels=rep("",5))+#
  scale_y_continuous(name=bquote(" U/ "* U[MSY]), limits = c(0,2.5)) +#
  geom_vline(xintercept=1) +#
  geom_hline(yintercept=1) +#
  geom_point(aes(x=S_Smsy_1980s, y=U_Umsy_1980s), size=2.5,alpha=0.45,shape=16) +#
  theme_bw() +#
  theme(panel.background = element_blank(),panel.grid = element_blank(), #
        plot.margin = unit(c(0,0.2,0.2,0), "lines"), legend.position="none",#
        panel.border = element_rect(colour = "black", fill=NA, size=1.5)) +#
  annotate("text", x=0.2, y=2.5, label= "1980s",size=5) +#
  annotate("text", x=4, y=2.5, label="A", size=6)
ggplot(data = dat) +#
  stat_density_2d(aes(x=S_Smsy_1980s, y=U_Umsy_1980s, fill = stat(level)), geom="polygon", h=bandwidth) +#
  scale_fill_distiller(palette=12, direction=1) +#
  scale_x_continuous("",limits = c(0,4),labels=rep("",5))+#
  scale_y_continuous(name=bquote(" U/ "* U[MSY]), limits = c(0,2.5)) +#
  geom_vline(xintercept=1) +#
  geom_hline(yintercept=1) +#
  geom_point(aes(x=S_Smsy_1980s, y=U_Umsy_1980s), size=2.5,alpha=0.45,shape=16) +#
  theme_bw() +#
  theme(panel.background = element_blank(),panel.grid = element_blank(), #
        plot.margin = unit(c(0,0.2,0.2,0), "lines"), legend.position="none",#
        panel.border = element_rect(colour = "black", fill=NA, size=1)) +#
  annotate("text", x=0.2, y=2.5, label= "1980s",size=5) +#
  annotate("text", x=4, y=2.5, label="A", size=6)
ggplot(data = dat) +#
  stat_density_2d(aes(x=S_Smsy_1980s, y=U_Umsy_1980s, fill = stat(level)), geom="polygon", h=bandwidth) +#
  scale_fill_distiller(palette=12, direction=1) +#
  scale_x_continuous("",limits = c(0,4),labels=rep("",5))+#
  scale_y_continuous(name=bquote(" U/ "* U[MSY]), limits = c(0,2.5)) +#
  geom_vline(xintercept=1, size=1) +#
  geom_hline(yintercept=1, size=1) +#
  geom_point(aes(x=S_Smsy_1980s, y=U_Umsy_1980s), size=3,alpha=0.55,shape=16) +#
  theme_bw() +#
  theme(panel.background = element_blank(),panel.grid = element_blank(), #
        plot.margin = unit(c(0,0.2,0.2,0), "lines"), legend.position="none",#
        panel.border = element_rect(colour = "black", fill=NA, size=1.5))
ggplot(data = dat) +#
  stat_density_2d(aes(x=S_Smsy_1980s, y=U_Umsy_1980s, fill = stat(level)), geom="polygon", h=bandwidth) +#
  scale_fill_distiller(palette=12, direction=1) +#
  scale_x_continuous("",limits = c(0,4),labels=rep("",5))+#
  scale_y_continuous(name=bquote(" U/ "* U[MSY]), limits = c(0,2.5)) +#
  geom_vline(xintercept=1, size=1) +#
  geom_hline(yintercept=1, size=1) +#
  geom_point(aes(x=S_Smsy_1980s, y=U_Umsy_1980s), size=3,alpha=0.55,shape=16) +#
  theme_bw() +#
  theme(panel.background = element_blank(),panel.grid = element_blank(), #
        plot.margin = unit(c(0,0.2,0.2,0), "lines"), legend.position="none",#
        panel.border = element_rect(colour = "black", fill=NA, size=1))
ggplot(data = dat) +#
  stat_density_2d(aes(x=S_Smsy_1980s, y=U_Umsy_1980s, fill = stat(level)), geom="polygon", h=bandwidth) +#
  scale_fill_distiller(palette=12, direction=1) +#
  scale_x_continuous("",limits = c(0,4),labels=rep("",5))+#
  scale_y_continuous(name=bquote(" U/ "* U[MSY]), limits = c(0,2.5)) +#
  geom_vline(xintercept=1, size=1) +#
  geom_hline(yintercept=1, size=1) +#
  geom_point(aes(x=S_Smsy_1980s, y=U_Umsy_1980s), size=3,alpha=0.55,shape=16) +#
  theme_bw() +#
  theme(panel.background = element_blank(),panel.grid = element_blank(), #
        plot.margin = unit(c(0,0.2,0.2,0), "lines"), legend.position="none",#
        panel.border = element_rect(colour = "black", fill=NA, size=1)) +#
  annotate("text", x=0.2, y=2.5, label= "1980s",size=5) +#
  annotate("text", x=4, y=2.5, label="A", size=6)
ggplot(data = dat) +#
  stat_density_2d(aes(x=S_Smsy_1980s, y=U_Umsy_1980s, fill = stat(level)), geom="polygon", h=bandwidth) +#
  scale_fill_distiller(palette=12, direction=1) +#
  scale_x_continuous("",limits = c(0,4),labels=rep("",5))+#
  scale_y_continuous(name=bquote(" U/ "* U[MSY]), limits = c(0,2.5)) +#
  geom_vline(xintercept=1) +#
  geom_hline(yintercept=1) +#
  geom_point(aes(x=S_Smsy_1980s, y=U_Umsy_1980s), size=2.5,alpha=0.45,shape=16) +#
  theme_bw() +#
  theme(panel.background = element_blank(),panel.grid = element_blank(), #
        plot.margin = unit(c(0,0.2,0.2,0), "lines"), legend.position="none",#
        panel.border = element_rect(colour = "black", fill=NA, size=1)) +#
  annotate("text", x=0.2, y=2.5, label= "1980s",size=5) +#
  annotate("text", x=4, y=2.5, label="A", size=6)
ggplot(data = dat) +#
  stat_density_2d(aes(x=S_Smsy_1980s, y=U_Umsy_1980s, fill = stat(level)), geom="polygon", h=bandwidth) +#
  scale_fill_distiller(palette=12, direction=1) +#
  scale_x_continuous("",limits = c(0,4),labels=rep("",5))+#
  scale_y_continuous(name=bquote(" U/ "* U[MSY]), limits = c(0,2.5)) +#
  geom_vline(xintercept=1) +#
  geom_hline(yintercept=1) +#
  geom_point(aes(x=S_Smsy_1980s, y=U_Umsy_1980s), size=2.5,alpha=0.45,shape=16) +#
  theme_bw() +#
  theme(panel.background = element_blank(),panel.grid = element_blank(), #
        plot.margin = unit(c(0,0.2,0.2,0), "lines"), legend.position="none",#
        panel.border = element_rect(colour = "black", fill=NA, size=1)) +#
  annotate("text", x=0.2, y=2.5, label= "1980s",size=5) +#
  annotate("text", x=-1, y=2.5, label="A", size=6)
ggplot(data = dat) +#
  stat_density_2d(aes(x=S_Smsy_1980s, y=U_Umsy_1980s, fill = stat(level)), geom="polygon", h=bandwidth) +#
  scale_fill_distiller(palette=12, direction=1) +#
  scale_x_continuous("",limits = c(0,4),labels=rep("",5))+#
  scale_y_continuous(name=bquote(" U/ "* U[MSY]), limits = c(0,2.5)) +#
  geom_vline(xintercept=1) +#
  geom_hline(yintercept=1) +#
  geom_point(aes(x=S_Smsy_1980s, y=U_Umsy_1980s), size=2.5,alpha=0.45,shape=16) +#
  theme_bw() +#
  theme(panel.background = element_blank(),panel.grid = element_blank(), #
        plot.margin = unit(c(0,0.2,0.2,0), "lines"), legend.position="none",#
        panel.border = element_rect(colour = "black", fill=NA, size=1)) +#
  annotate("text", x=0.2, y=2.5, label= "1980s",size=5) +#
  annotate("text", x=0, y=2.5, label="A", size=6)
ggplot(data = dat) +#
  stat_density_2d(aes(x=S_Smsy_1980s, y=U_Umsy_1980s, fill = stat(level)), geom="polygon", h=bandwidth) +#
  scale_fill_distiller(palette=12, direction=1) +#
  scale_x_continuous("",limits = c(0,4),labels=rep("",5))+#
  scale_y_continuous(name=bquote(" U/ "* U[MSY]), limits = c(0,2.5)) +#
  geom_vline(xintercept=1) +#
  geom_hline(yintercept=1) +#
  geom_point(aes(x=S_Smsy_1980s, y=U_Umsy_1980s), size=2.5,alpha=0.45,shape=16) +#
  theme_bw() +#
  theme(panel.background = element_blank(),panel.grid = element_blank(), #
        plot.margin = unit(c(0,0.2,0.2,0), "lines"), legend.position="none",#
        panel.border = element_rect(colour = "black", fill=NA, size=1)) +#
  annotate("text", x=0.2, y=2.5, label= "1980s",size=5) +#
  annotate("text", x=-0.01, y=2.5, label="A", size=6)
ggplot(data = dat) +#
  stat_density_2d(aes(x=S_Smsy_1980s, y=U_Umsy_1980s, fill = stat(level)), geom="polygon", h=bandwidth) +#
  scale_fill_distiller(palette=12, direction=1) +#
  scale_x_continuous("",limits = c(0,4),labels=rep("",5), oob =scales::squish)+#
  scale_y_continuous(name=bquote(" U/ "* U[MSY]), limits = c(0,2.5)) +#
  geom_vline(xintercept=1) +#
  geom_hline(yintercept=1) +#
  geom_point(aes(x=S_Smsy_1980s, y=U_Umsy_1980s), size=2.5,alpha=0.45,shape=16) +#
  theme_bw() +#
  theme(panel.background = element_blank(),panel.grid = element_blank(), #
        plot.margin = unit(c(0,0.2,0.2,0), "lines"), legend.position="none",#
        panel.border = element_rect(colour = "black", fill=NA, size=1))
annotate("text", x=-0.01, y=2.5, label="A", size=6)
ggplot(data = dat) +#
  stat_density_2d(aes(x=S_Smsy_1980s, y=U_Umsy_1980s, fill = stat(level)), geom="polygon", h=bandwidth) +#
  scale_fill_distiller(palette=12, direction=1) +#
  scale_x_continuous("",limits = c(0,4),labels=rep("",5), oob =scales::squish)+#
  scale_y_continuous(name=bquote(" U/ "* U[MSY]), limits = c(0,2.5)) +#
  geom_vline(xintercept=1) +#
  geom_hline(yintercept=1) +#
  geom_point(aes(x=S_Smsy_1980s, y=U_Umsy_1980s), size=2.5,alpha=0.45,shape=16) +#
  theme_bw() +#
  theme(panel.background = element_blank(),panel.grid = element_blank(), #
        plot.margin = unit(c(0,0.2,0.2,0), "lines"), legend.position="none",#
        panel.border = element_rect(colour = "black", fill=NA, size=1)) +#
  annotate("text", x=0.2, y=2.5, label= "1980s",size=5) +#
  annotate("text", x=-0.01, y=2.5, label="A", size=6)
ggplot(data = dat) +#
  stat_density_2d(aes(x=S_Smsy_1980s, y=U_Umsy_1980s, fill = stat(level)), geom="polygon", h=bandwidth) +#
  scale_fill_distiller(palette=12, direction=1) +#
  scale_x_continuous("",limits = c(0,4),labels=rep("",5), oob =scales::squish)+#
  scale_y_continuous(name=bquote(" U/ "* U[MSY]), limits = c(0,2.5)) +#
  geom_vline(xintercept=1) +#
  geom_hline(yintercept=1) +#
  geom_point(aes(x=S_Smsy_1980s, y=U_Umsy_1980s), size=2.5,alpha=0.45,shape=16) +#
  theme_bw() +#
  theme(panel.background = element_blank(),panel.grid = element_blank(), #
        plot.margin = unit(c(0,0.2,0.2,0), "lines"), legend.position="none",#
        panel.border = element_rect(colour = "black", fill=NA, size=1)) +#
  annotate("text", x=0.2, y=2.5, label= "1980s",size=5) +#
  annotate("text", x=-0.5, y=2.5, label="A", size=6)
ggplot(data = dat) +#
  stat_density_2d(aes(x=S_Smsy_1980s, y=U_Umsy_1980s, fill = stat(level)), geom="polygon", h=bandwidth) +#
  scale_fill_distiller(palette=12, direction=1) +#
  scale_x_continuous("",limits = c(0,4),labels=rep("",5), oob =scales::squish)+#
  scale_y_continuous(name=bquote(" U/ "* U[MSY]), limits = c(0,2.5)) +#
  geom_vline(xintercept=1) +#
  geom_hline(yintercept=1) +#
  geom_point(aes(x=S_Smsy_1980s, y=U_Umsy_1980s), size=2.5,alpha=0.45,shape=16) +#
  theme_bw() +#
  theme(panel.background = element_blank(),panel.grid = element_blank(), #
        plot.margin = unit(c(0,0.2,0.2,0), "lines"), legend.position="none",#
        panel.border = element_rect(colour = "black", fill=NA, size=1)) +#
  annotate("text", x=0.2, y=2.5, label= "1980s",size=5) +#
  annotate("text", x=-1, y=2.5, label="A", size=6)
ggplot(data = dat) +#
  stat_density_2d(aes(x=S_Smsy_1980s, y=U_Umsy_1980s, fill = stat(level)), geom="polygon", h=bandwidth) +#
  scale_fill_distiller(palette=12, direction=1) +#
  scale_x_continuous("",limits = c(0,4),labels=rep("",5), oob =scales::squish)+#
  scale_y_continuous(name=bquote(" U/ "* U[MSY]), limits = c(0,2.5)) +#
  geom_vline(xintercept=1) +#
  geom_hline(yintercept=1) +#
  geom_point(aes(x=S_Smsy_1980s, y=U_Umsy_1980s), size=2.5,alpha=0.45,shape=16) +#
  theme_bw() +#
  theme(panel.background = element_blank(),panel.grid = element_blank(), #
        plot.margin = unit(c(0,0.2,0.2,0), "lines"), legend.position="none",#
        panel.border = element_rect(colour = "black", fill=NA, size=1)) +#
  annotate("text", x=0.2, y=2.5, label= "1980s",size=5) +#
  annotate("text", x=-5, y=2.5, label="A", size=6)
ggplot(data = dat) +#
  stat_density_2d(aes(x=S_Smsy_1980s, y=U_Umsy_1980s, fill = stat(level)), geom="polygon", h=bandwidth) +#
  scale_fill_distiller(palette=12, direction=1) +#
  scale_x_continuous("",limits = c(0,4),labels=rep("",5), oob =scales::squish)+#
  scale_y_continuous(name=bquote(" U/ "* U[MSY]), limits = c(0,2.5)) +#
  coord_cartesian(xlim - c(0,4))+#
  geom_vline(xintercept=1) +#
  geom_hline(yintercept=1) +#
  geom_point(aes(x=S_Smsy_1980s, y=U_Umsy_1980s), size=2.5,alpha=0.45,shape=16) +#
  theme_bw() +#
  theme(panel.background = element_blank(),panel.grid = element_blank(), #
        plot.margin = unit(c(0,0.2,0.2,0), "lines"), legend.position="none",#
        panel.border = element_rect(colour = "black", fill=NA, size=1)) +#
  annotate("text", x=0.2, y=2.5, label= "1980s",size=5) +#
  annotate("text", x=-5, y=2.5, label="A", size=6)
ggplot(data = dat) +#
  stat_density_2d(aes(x=S_Smsy_1980s, y=U_Umsy_1980s, fill = stat(level)), geom="polygon", h=bandwidth) +#
  scale_fill_distiller(palette=12, direction=1) +#
  scale_x_continuous("",limits = c(0,4),labels=rep("",5), oob =scales::squish)+#
  scale_y_continuous(name=bquote(" U/ "* U[MSY]), limits = c(0,2.5)) +#
  coord_cartesian(xlim = c(0,4))+#
  geom_vline(xintercept=1) +#
  geom_hline(yintercept=1) +#
  geom_point(aes(x=S_Smsy_1980s, y=U_Umsy_1980s), size=2.5,alpha=0.45,shape=16) +#
  theme_bw() +#
  theme(panel.background = element_blank(),panel.grid = element_blank(), #
        plot.margin = unit(c(0,0.2,0.2,0), "lines"), legend.position="none",#
        panel.border = element_rect(colour = "black", fill=NA, size=1)) +#
  annotate("text", x=0.2, y=2.5, label= "1980s",size=5) +#
  annotate("text", x=-5, y=2.5, label="A", size=6)
ggplot(data = dat) +#
  stat_density_2d(aes(x=S_Smsy_1980s, y=U_Umsy_1980s, fill = stat(level)), geom="polygon", h=bandwidth) +#
  scale_fill_distiller(palette=12, direction=1) +#
  scale_x_continuous("",limits = c(0,4),labels=rep("",5), oob =scales::squish)+#
  scale_y_continuous(name=bquote(" U/ "* U[MSY]), limits = c(0,2.5)) +#
  coord_cartesian(xlim = c(0,4))+#
  geom_vline(xintercept=1) +#
  geom_hline(yintercept=1) +#
  geom_point(aes(x=S_Smsy_1980s, y=U_Umsy_1980s), size=2.5,alpha=0.45,shape=16) +#
  theme_bw() +#
  theme(panel.background = element_blank(),panel.grid = element_blank(), #
        plot.margin = unit(c(0,0.2,0.2,0), "lines"), legend.position="none",#
        panel.border = element_rect(colour = "black", fill=NA, size=1)) +#
  annotate("text", x=0.2, y=2.5, label= "1980s",size=5) +#
  annotate("text", x=2, y=2.5, label="A", size=6)
ggplot(data = dat) +#
  stat_density_2d(aes(x=S_Smsy_1980s, y=U_Umsy_1980s, fill = stat(level)), geom="polygon", h=bandwidth) +#
  scale_fill_distiller(palette=12, direction=1) +#
  scale_x_continuous("",limits = c(0,4),labels=rep("",5), oob =scales::squish)+#
  scale_y_continuous(name=bquote(" U/ "* U[MSY]), limits = c(0,2.5)) +#
  coord_cartesian(xlim = c(0,4), clip = "off")+#
  geom_vline(xintercept=1) +#
  geom_hline(yintercept=1) +#
  geom_point(aes(x=S_Smsy_1980s, y=U_Umsy_1980s), size=2.5,alpha=0.45,shape=16) +#
  theme_bw() +#
  theme(panel.background = element_blank(),panel.grid = element_blank(), #
        plot.margin = unit(c(0,0.2,0.2,0), "lines"), legend.position="none",#
        panel.border = element_rect(colour = "black", fill=NA, size=1)) +#
  annotate("text", x=0.2, y=2.5, label= "1980s",size=5) +#
  annotate("text", x=2, y=2.5, label="A", size=6)
ggplot(data = dat) +#
  stat_density_2d(aes(x=S_Smsy_1980s, y=U_Umsy_1980s, fill = stat(level)), geom="polygon", h=bandwidth) +#
  scale_fill_distiller(palette=12, direction=1) +#
  scale_x_continuous("",limits = c(0,4),labels=rep("",5), oob =scales::squish)+#
  scale_y_continuous(name=bquote(" U/ "* U[MSY]), limits = c(0,2.5)) +#
  coord_cartesian(xlim = c(0,4), clip = "off")+#
  geom_vline(xintercept=1) +#
  geom_hline(yintercept=1) +#
  geom_point(aes(x=S_Smsy_1980s, y=U_Umsy_1980s), size=2.5,alpha=0.45,shape=16) +#
  theme_bw() +#
  theme(panel.background = element_blank(),panel.grid = element_blank(), #
        plot.margin = unit(c(0,0.2,0.2,0), "lines"), legend.position="none",#
        panel.border = element_rect(colour = "black", fill=NA, size=1)) +#
  annotate("text", x=0.2, y=2.5, label= "1980s",size=5) +#
  annotate("text", x=-1, y=2.5, label="A", size=6)
ggplot(data = dat) +#
  stat_density_2d(aes(x=S_Smsy_1980s, y=U_Umsy_1980s, fill = stat(level)), geom="polygon", h=bandwidth) +#
  scale_fill_distiller(palette=12, direction=1) +#
  scale_x_continuous("",limits = c(0,4),labels=rep("",5), oob =scales::squish)+#
  scale_y_continuous(name=bquote(" U/ "* U[MSY]), limits = c(0,2.5)) +#
  coord_cartesian(xlim = c(0,4), clip = "off")+#
  geom_vline(xintercept=1) +#
  geom_hline(yintercept=1) +#
  geom_point(aes(x=S_Smsy_1980s, y=U_Umsy_1980s), size=2.5,alpha=0.45,shape=16) +#
  theme_bw() +#
  theme(panel.background = element_blank(),panel.grid = element_blank(), #
        plot.margin = unit(c(0,0.2,0.2,0), "lines"), legend.position="none",#
        panel.border = element_rect(colour = "black", fill=NA, size=1)) +#
  annotate("text", x=0.2, y=2.5, label= "1980s",size=5) +#
  annotate("text", x=-2, y=2.5, label="A", size=6)
bandwidth = c(0.8,.8)#
# bandwidth feels super arbitrary -- where it basically sets how tight the #
# contours are around the points, the first one sets in the x direction and the#
# second in the y direction (though they seem to interact)... as soon as the #
# first element jumps to 0.9, we start to get the weird splits in the Skeena#
# 2000s plot... c(0.8, 1) seems to be the closest to what we had before, but#
# without the overstretching in the Skeena plot...#
# CHANGE: since we reduced the y axis from c(0,4) to c(0,2.5) this changed#
# to c(0.8, 0.8)#
#
#############
### BBay ####
#############
dat = all.dat[all.dat$system==systems[1],]#
colors <- colorRampPalette(c("white", "#458B74", "#2F4F4F"))(10)#
p1 <- ggplot(data = dat) +#
  stat_density_2d(aes(x=S_Smsy_1980s, y=U_Umsy_1980s, fill = stat(level)), geom="polygon", h=bandwidth) +#
  scale_fill_distiller(palette=12, direction=1) +#
  scale_x_continuous("",limits = c(0,4),labels=rep("",5))+#
  scale_y_continuous(name=bquote(" U/ "* U[MSY]), limits = c(0,2.5)) +#
  geom_vline(xintercept=1) +#
  geom_hline(yintercept=1) +#
  geom_point(aes(x=S_Smsy_1980s, y=U_Umsy_1980s), size=2.5,alpha=0.45,shape=16) +#
  theme_bw() +#
  theme(panel.background = element_blank(),panel.grid = element_blank(), #
        plot.margin = unit(c(0,0.2,0.2,0), "lines"), legend.position="none",#
        panel.border = element_rect(colour = "black", fill=NA, size=1)) +#
  ##annotate("text", x=0.2, y=2.5, label= "1980s",size=5) +#
  ##annotate("text", x=-0.01, y=2.5, label="A", size=6)#
#
p2 <- ggplot(data = dat) +#
  stat_density_2d(aes(x=S_Smsy_2000s, y=U_Umsy_2000s, fill = stat(level)), geom="polygon", h=bandwidth) +#
  scale_fill_distiller(palette=12, direction=1) +#
  geom_point(aes(S_Smsy_2000s, U_Umsy_2000s), size=2.5,alpha=0.45,shape=16) +#
  scale_x_continuous("",limits = c(0,4),labels=rep("",5))+#
  scale_y_continuous("",limits = c(0,2.5),labels = NULL)+#
  geom_vline(xintercept=1)+#
  geom_hline(yintercept=1)+#
  theme_bw()+#
  theme(panel.background = element_blank(),panel.grid = element_blank(), #
        plot.margin = unit(c(0,0.2,0.2,0), "lines"), legend.position="none",#
        panel.border = element_rect(colour = "black", fill=NA, size=1)) +#
  #annotate("text", x=0.2, y=2.5,   label= "2000s",size=5)+#
  #annotate("text", x=2.5, y=2.5,   label= "Bristol Bay",size=5)+#
  #annotate("text", x=4, y=2.5, label="B", size=6)#
p3 <- ggplot(data=dat) +#
  geom_density(aes(x=S_Smsy_1980s, group=system,fill=system),alpha=0.65, adjust=3, linetype="dashed")+ #
  geom_density(aes(x=S_Smsy_2000s, group=system,fill=system),alpha=0.45, adjust=3)+ #
  scale_fill_manual(values=c("#5D478B"))+#
  scale_x_continuous(limits = c(0,4))+#
  coord_cartesian(ylim=c(0,1.2))+#
  theme(panel.background = element_blank(),axis.text = element_blank(), #
        axis.ticks=element_blank(),axis.title=element_blank())+#
  theme(legend.position="none",plot.margin = unit(c(0,0.2,2,.2), "lines"))+#
  geom_vline(xintercept=1) +#
  #annotate("text", x=3, y=0.7, label= "S/Smsy", size=4)+#
  #annotate("text", x=4, y=1.1, label="D", size=6)#
#
p4 <- ggplot(data=dat) +#
  geom_density(aes(x=U_Umsy_1980s, group=system,fill=system),alpha=0.65, adjust=3, linetype="dashed")+ #
  geom_density(aes(x=U_Umsy_2000s, group=system,fill=system),alpha=0.45, adjust=3)+ #
  scale_fill_manual(values=c("#5D478B"))+#
  coord_flip(ylim=c(0,1.5))+#
  # coord_cartesian()+#
  scale_x_continuous(name=bquote(" U/ "* U[MSY]),limits = c(0,2.5)) +#
  theme(panel.background = element_blank(),axis.text = element_blank(), #
        axis.ticks=element_blank(),axis.title=element_blank())+#
  theme(legend.position="none",plot.margin = unit(c(0,0.2,2,.2), "lines"))+#
  geom_vline(xintercept=1) +#
  #annotate("text", x=2, y=1.2, label= "U/Umsy", size=4)+#
  #annotate("text", x=2.3, y=1.5, label="C", size=6)#
###############
### Skeena ####
###############
dat = all.dat[all.dat$system==systems[3],]#
#
p9 <- ggplot(data = dat) +#
  stat_density_2d(aes(x=S_Smsy_1980s, y=U_Umsy_1980s, fill = stat(level)), geom = "polygon", h=bandwidth) +#
  scale_fill_distiller(palette=2, direction=1) +#
  geom_point(aes(S_Smsy_1980s, U_Umsy_1980s), size=2.5,alpha=0.45, shape=16) +#
  scale_x_continuous("",limits = c(0,4),labels=rep("",5))+#
  scale_y_continuous(name=bquote(" U/ "* U[MSY]),limits = c(0,2.5))+#
  geom_vline(xintercept=1)+#
  geom_hline(yintercept=1)+#
  theme_bw()+#
  theme(panel.background = element_blank(),panel.grid = element_blank(), #
        plot.margin = unit(c(0,0.2,0.2,0), "lines"), legend.position="none",#
        panel.border = element_rect(colour = "black", fill=NA, size=1)) +#
  #annotate("text", x=4, y=2.5, label="E", size=6)#
#
p10 <- ggplot(data = dat) +#
  stat_density_2d(aes(x=S_Smsy_2000s, y=U_Umsy_2000s, fill = stat(level)), geom = "polygon", h=bandwidth) +#
  scale_fill_distiller(palette=2, direction=1) +#
  geom_point(aes(S_Smsy_2000s, U_Umsy_2000s), size=2.5,alpha=0.45,shape=16) +#
  scale_x_continuous("",limits = c(0,4),labels=rep("",5))+#
  scale_y_continuous("",limits = c(0,2.5),labels = NULL)+#
  geom_vline(xintercept=1)+#
  geom_hline(yintercept=1)+#
  theme_bw()+#
  theme(panel.background = element_blank(),panel.grid = element_blank(), #
        plot.margin = unit(c(0,0.2,0.2,0), "lines"), legend.position="none",#
        panel.border = element_rect(colour = "black", fill=NA, size=1)) +#
  #annotate("text", x=2.5, y=2.5,   label= "Skeena River",size=5)+#
  #annotate("text", x=4, y=2.5, label="F", size=6)#
#
p11 <- ggplot(data=dat) +#
  geom_density(aes(x=S_Smsy_1980s, group=system,fill=system),alpha=0.65, adjust=3, linetype="dashed")+ #
  geom_density(aes(x=S_Smsy_2000s, group=system,fill=system),alpha=0.45, adjust=3)+ #
  scale_fill_manual(values=c("#2E8B57"))+#
  scale_x_continuous(name=bquote(" S/"* S[MSY]),limits = c(0,4),position = "bottom") +#
  #scale_x_continuous(limits = c(0,4))+#
  coord_cartesian(ylim=c(0,1.2))+#
  theme(panel.background = element_blank(),axis.text = element_blank(), #
        axis.ticks=element_blank(),axis.title=element_blank())+#
  theme(legend.position="none",plot.margin = unit(c(0,0.2,2,.2), "lines"))+#
  geom_vline(xintercept=1)+#
  # #annotate("text", x=3, y=0.7, label= "S/Smsy", size=4)+#
  #annotate("text", x=4, y=1.1, label="H", size=6)#
#
p12 <- ggplot(data=dat) +#
  geom_density(aes(x=U_Umsy_1980s, group=system,fill=system),alpha=0.65, adjust=3, linetype="dashed")+ #
  geom_density(aes(x=U_Umsy_2000s, group=system,fill=system),alpha=0.45, adjust=3)+ #
  scale_fill_manual(values=c("#2E8B57"))+#
  coord_flip(ylim=c(0,1.5))+#
  # coord_cartesian(ylim=c(0,1.2))+#
  scale_x_continuous(limits = c(0,2.5))+#
  theme(panel.background = element_blank(),axis.text = element_blank(), #
        axis.ticks=element_blank(),axis.title=element_blank())+#
  theme(legend.position="none",plot.margin = unit(c(0,0.2,2,.2), "lines"))+#
  geom_vline(xintercept=1) +#
  # #annotate("text", x=2, y=1.2, label= "U/Umsy", size=4)+#
  #annotate("text", x=2.3, y=1.5, label="G", size=6)#
###############
### Fraser ####
###############
dat = all.dat[all.dat$system==systems[2],]#
#
p5 <- ggplot(data = dat) +#
  stat_density_2d(aes(x=S_Smsy_1980s, y=U_Umsy_1980s, fill = stat(level)), geom="polygon", h=bandwidth) +#
  scale_fill_distiller(palette=1, direction=1) +#
  geom_point(aes(S_Smsy_1980s, U_Umsy_1980s), size=2.5,alpha=0.45,shape=16) +#
  scale_x_continuous(name=bquote(" S/"* S[MSY]),limits = c(0,4), position = "bottom")+#
  scale_y_continuous(name=bquote(" U/ "* U[MSY]),limits = c(0,2.5))+#
  geom_vline(xintercept=1)+#
  geom_hline(yintercept=1)+#
  theme_bw()+#
  theme(panel.background = element_blank(),panel.grid = element_blank(), #
        plot.margin = unit(c(0,0.2,0.2,0), "lines"), legend.position="none",#
        panel.border = element_rect(colour = "black", fill=NA, size=1)) +#
  #annotate("text", x=4, y=2.5, label="I", size=6)#
#
p6 <- ggplot(data = dat) +#
  stat_density_2d(aes(x=S_Smsy_2000s, y=U_Umsy_2000s, fill = stat(level)), geom="polygon", h=bandwidth) +#
  scale_fill_distiller(palette=1, direction=1) +#
  geom_point(aes(S_Smsy_2000s, U_Umsy_2000s), size=2.5,alpha=0.45,shape=16) +#
  scale_x_continuous(name=bquote(" S/"* S[MSY]),limits = c(0,4), position = "bottom")+#
  scale_y_continuous("",limits = c(0,2.5),labels = NULL)+#
  geom_vline(xintercept=1)+#
  geom_hline(yintercept=1)+#
  theme_bw()+#
  theme(panel.background = element_blank(),panel.grid = element_blank(), #
        plot.margin = unit(c(0,0.2,0.2,0), "lines"), legend.position="none",#
        panel.border = element_rect(colour = "black", fill=NA, size=1)) +#
  #annotate("text", x=2.5, y=2.5,   label= "Fraser River",size=5)+#
  #annotate("text", x=4, y=2.5, label="J", size=6)#
#
p7 <- ggplot(data=dat) +#
  geom_density(aes(x=S_Smsy_1980s, group=system,fill=system),alpha=0.65, adjust=3, linetype="dashed")+ #
  geom_density(aes(x=S_Smsy_2000s, group=system,fill=system),alpha=0.45, adjust=3)+ #
  scale_fill_manual(values=c("#104E8B"))+#
  scale_x_continuous(limits = c(0,4))+#
  coord_cartesian(ylim=c(0,1.2))+#
  theme(panel.background = element_blank(),axis.text = element_blank(), #
        axis.ticks=element_blank(),axis.title=element_blank())+#
  theme(legend.position="none",plot.margin = unit(c(0,0.2,2,.2), "lines"))+#
  geom_vline(xintercept=1) +#
  # #annotate("text", x=3, y=0.7, label= "S/Smsy", size=4)+#
  #annotate("text", x=4, y=1.1, label="L", size=6)#
p8 <- ggplot(data=dat) +#
  geom_density(aes(x=U_Umsy_1980s, group=system,fill=system),alpha=0.65, adjust=3, linetype="dashed")+ #
  geom_density(aes(x=U_Umsy_2000s, group=system,fill=system),alpha=0.45, adjust=3)+ #
  scale_fill_manual(values=c("#104E8B"))+#
  coord_flip(ylim=c(0,1.5))+#
  # coord_cartesian(ylim=c(0,1.2))+#
  scale_x_continuous(limits = c(0,2.5))+#
  theme(panel.background = element_blank(),axis.text = element_blank(), #
        axis.ticks=element_blank(),axis.title=element_blank())+#
  theme(legend.position="none",plot.margin = unit(c(0,0.2,2,.2), "lines"))+#
  geom_vline(xintercept=1) +#
  # #annotate("text", x=2, y=1.2, label= "U/Umsy", size=4)+#
  #annotate("text", x=2.3, y=1.5, label="K", size=6)#
# pdf("AllSystems_12panel.pdf", width=11, height=8)#
# grid.arrange(p1,p2,p3,p4,p5,p6,p7,p8,p9,p10,p11,p12,#
#              layout_matrix=rbind(c(1,2,3,4), c(5,6,7,8), c(9,10,11,12)))#
# dev.off()#
# #
# layout.mat <- matrix(c(1,1,2,2,3,NA,#
#                        1,1,2,2,NA,4,#
#                        5,5,6,6,7,NA,#
#                        5,5,6,6,NA,8,#
#                        9,9,10,10,11,NA,#
#                        9,9,10,10,NA,12), nrow=6, byrow=TRUE)#
#
layout.mat <- matrix(c(1,1,2,2,3,#
                       1,1,2,2,4,#
                       5,5,6,6,7,#
                       5,5,6,6,8,#
                       9,9,10,10,11,#
                       9,9,10,10,12), nrow=6, byrow=TRUE)#
pdf(paste("AllSystems_12panel_", yr.range, "yrs_11.27.2019.pdf", sep=""),#
    width=7, height=8.5) # REDUCE PDF WIDTH#
grid.arrange(p1,p2,p4,p3,p9,p10,p12,p11,p5,p6,p8,p7,#
             layout_matrix=layout.mat)#
              # , labels = c("A", "B", "C", "D", "E", "F", "G", "H"))#
             # labels=c("A", "")) # ADD THE LABELS HERE!#
dev.off()
bandwidth = c(0.8,.8)#
# bandwidth feels super arbitrary -- where it basically sets how tight the #
# contours are around the points, the first one sets in the x direction and the#
# second in the y direction (though they seem to interact)... as soon as the #
# first element jumps to 0.9, we start to get the weird splits in the Skeena#
# 2000s plot... c(0.8, 1) seems to be the closest to what we had before, but#
# without the overstretching in the Skeena plot...#
# CHANGE: since we reduced the y axis from c(0,4) to c(0,2.5) this changed#
# to c(0.8, 0.8)#
#
#############
### BBay ####
#############
dat = all.dat[all.dat$system==systems[1],]#
colors <- colorRampPalette(c("white", "#458B74", "#2F4F4F"))(10)#
p1 <- ggplot(data = dat) +#
  stat_density_2d(aes(x=S_Smsy_1980s, y=U_Umsy_1980s, fill = stat(level)), geom="polygon", h=bandwidth) +#
  scale_fill_distiller(palette=12, direction=1) +#
  scale_x_continuous("",limits = c(0,4),labels=rep("",5))+#
  scale_y_continuous(name=bquote(" U/ "* U[MSY]), limits = c(0,2.5)) +#
  geom_vline(xintercept=1) +#
  geom_hline(yintercept=1) +#
  geom_point(aes(x=S_Smsy_1980s, y=U_Umsy_1980s), size=2.5,alpha=0.45,shape=16) +#
  theme_bw() +#
  theme(panel.background = element_blank(),panel.grid = element_blank(), #
        plot.margin = unit(c(0,0.2,0.2,0), "lines"), legend.position="none",#
        panel.border = element_rect(colour = "black", fill=NA, size=1)) #
  ##annotate("text", x=0.2, y=2.5, label= "1980s",size=5) +#
  ##annotate("text", x=-0.01, y=2.5, label="A", size=6)#
#
p2 <- ggplot(data = dat) +#
  stat_density_2d(aes(x=S_Smsy_2000s, y=U_Umsy_2000s, fill = stat(level)), geom="polygon", h=bandwidth) +#
  scale_fill_distiller(palette=12, direction=1) +#
  geom_point(aes(S_Smsy_2000s, U_Umsy_2000s), size=2.5,alpha=0.45,shape=16) +#
  scale_x_continuous("",limits = c(0,4),labels=rep("",5))+#
  scale_y_continuous("",limits = c(0,2.5),labels = NULL)+#
  geom_vline(xintercept=1)+#
  geom_hline(yintercept=1)+#
  theme_bw()+#
  theme(panel.background = element_blank(),panel.grid = element_blank(), #
        plot.margin = unit(c(0,0.2,0.2,0), "lines"), legend.position="none",#
        panel.border = element_rect(colour = "black", fill=NA, size=1)) #
  #annotate("text", x=0.2, y=2.5,   label= "2000s",size=5)+#
  #annotate("text", x=2.5, y=2.5,   label= "Bristol Bay",size=5)+#
  #annotate("text", x=4, y=2.5, label="B", size=6)#
p3 <- ggplot(data=dat) +#
  geom_density(aes(x=S_Smsy_1980s, group=system,fill=system),alpha=0.65, adjust=3, linetype="dashed")+ #
  geom_density(aes(x=S_Smsy_2000s, group=system,fill=system),alpha=0.45, adjust=3)+ #
  scale_fill_manual(values=c("#5D478B"))+#
  scale_x_continuous(limits = c(0,4))+#
  coord_cartesian(ylim=c(0,1.2))+#
  theme(panel.background = element_blank(),axis.text = element_blank(), #
        axis.ticks=element_blank(),axis.title=element_blank())+#
  theme(legend.position="none",plot.margin = unit(c(0,0.2,2,.2), "lines"))+#
  geom_vline(xintercept=1) +#
  #annotate("text", x=3, y=0.7, label= "S/Smsy", size=4)+#
  #annotate("text", x=4, y=1.1, label="D", size=6)#
#
p4 <- ggplot(data=dat) +#
  geom_density(aes(x=U_Umsy_1980s, group=system,fill=system),alpha=0.65, adjust=3, linetype="dashed")+ #
  geom_density(aes(x=U_Umsy_2000s, group=system,fill=system),alpha=0.45, adjust=3)+ #
  scale_fill_manual(values=c("#5D478B"))+#
  coord_flip(ylim=c(0,1.5))+#
  # coord_cartesian()+#
  scale_x_continuous(name=bquote(" U/ "* U[MSY]),limits = c(0,2.5)) +#
  theme(panel.background = element_blank(),axis.text = element_blank(), #
        axis.ticks=element_blank(),axis.title=element_blank())+#
  theme(legend.position="none",plot.margin = unit(c(0,0.2,2,.2), "lines"))+#
  geom_vline(xintercept=1) +#
  #annotate("text", x=2, y=1.2, label= "U/Umsy", size=4)+#
  #annotate("text", x=2.3, y=1.5, label="C", size=6)#
###############
### Skeena ####
###############
dat = all.dat[all.dat$system==systems[3],]#
#
p9 <- ggplot(data = dat) +#
  stat_density_2d(aes(x=S_Smsy_1980s, y=U_Umsy_1980s, fill = stat(level)), geom = "polygon", h=bandwidth) +#
  scale_fill_distiller(palette=2, direction=1) +#
  geom_point(aes(S_Smsy_1980s, U_Umsy_1980s), size=2.5,alpha=0.45, shape=16) +#
  scale_x_continuous("",limits = c(0,4),labels=rep("",5))+#
  scale_y_continuous(name=bquote(" U/ "* U[MSY]),limits = c(0,2.5))+#
  geom_vline(xintercept=1)+#
  geom_hline(yintercept=1)+#
  theme_bw()+#
  theme(panel.background = element_blank(),panel.grid = element_blank(), #
        plot.margin = unit(c(0,0.2,0.2,0), "lines"), legend.position="none",#
        panel.border = element_rect(colour = "black", fill=NA, size=1)) #
  #annotate("text", x=4, y=2.5, label="E", size=6)#
#
p10 <- ggplot(data = dat) +#
  stat_density_2d(aes(x=S_Smsy_2000s, y=U_Umsy_2000s, fill = stat(level)), geom = "polygon", h=bandwidth) +#
  scale_fill_distiller(palette=2, direction=1) +#
  geom_point(aes(S_Smsy_2000s, U_Umsy_2000s), size=2.5,alpha=0.45,shape=16) +#
  scale_x_continuous("",limits = c(0,4),labels=rep("",5))+#
  scale_y_continuous("",limits = c(0,2.5),labels = NULL)+#
  geom_vline(xintercept=1)+#
  geom_hline(yintercept=1)+#
  theme_bw()+#
  theme(panel.background = element_blank(),panel.grid = element_blank(), #
        plot.margin = unit(c(0,0.2,0.2,0), "lines"), legend.position="none",#
        panel.border = element_rect(colour = "black", fill=NA, size=1)) #
  #annotate("text", x=2.5, y=2.5,   label= "Skeena River",size=5)+#
  #annotate("text", x=4, y=2.5, label="F", size=6)#
#
p11 <- ggplot(data=dat) +#
  geom_density(aes(x=S_Smsy_1980s, group=system,fill=system),alpha=0.65, adjust=3, linetype="dashed")+ #
  geom_density(aes(x=S_Smsy_2000s, group=system,fill=system),alpha=0.45, adjust=3)+ #
  scale_fill_manual(values=c("#2E8B57"))+#
  scale_x_continuous(name=bquote(" S/"* S[MSY]),limits = c(0,4),position = "bottom") +#
  #scale_x_continuous(limits = c(0,4))+#
  coord_cartesian(ylim=c(0,1.2))+#
  theme(panel.background = element_blank(),axis.text = element_blank(), #
        axis.ticks=element_blank(),axis.title=element_blank())+#
  theme(legend.position="none",plot.margin = unit(c(0,0.2,2,.2), "lines"))+#
  geom_vline(xintercept=1)+#
  # #annotate("text", x=3, y=0.7, label= "S/Smsy", size=4)+#
  #annotate("text", x=4, y=1.1, label="H", size=6)#
#
p12 <- ggplot(data=dat) +#
  geom_density(aes(x=U_Umsy_1980s, group=system,fill=system),alpha=0.65, adjust=3, linetype="dashed")+ #
  geom_density(aes(x=U_Umsy_2000s, group=system,fill=system),alpha=0.45, adjust=3)+ #
  scale_fill_manual(values=c("#2E8B57"))+#
  coord_flip(ylim=c(0,1.5))+#
  # coord_cartesian(ylim=c(0,1.2))+#
  scale_x_continuous(limits = c(0,2.5))+#
  theme(panel.background = element_blank(),axis.text = element_blank(), #
        axis.ticks=element_blank(),axis.title=element_blank())+#
  theme(legend.position="none",plot.margin = unit(c(0,0.2,2,.2), "lines"))+#
  geom_vline(xintercept=1) +#
  # #annotate("text", x=2, y=1.2, label= "U/Umsy", size=4)+#
  #annotate("text", x=2.3, y=1.5, label="G", size=6)#
###############
### Fraser ####
###############
dat = all.dat[all.dat$system==systems[2],]#
#
p5 <- ggplot(data = dat) +#
  stat_density_2d(aes(x=S_Smsy_1980s, y=U_Umsy_1980s, fill = stat(level)), geom="polygon", h=bandwidth) +#
  scale_fill_distiller(palette=1, direction=1) +#
  geom_point(aes(S_Smsy_1980s, U_Umsy_1980s), size=2.5,alpha=0.45,shape=16) +#
  scale_x_continuous(name=bquote(" S/"* S[MSY]),limits = c(0,4), position = "bottom")+#
  scale_y_continuous(name=bquote(" U/ "* U[MSY]),limits = c(0,2.5))+#
  geom_vline(xintercept=1)+#
  geom_hline(yintercept=1)+#
  theme_bw()+#
  theme(panel.background = element_blank(),panel.grid = element_blank(), #
        plot.margin = unit(c(0,0.2,0.2,0), "lines"), legend.position="none",#
        panel.border = element_rect(colour = "black", fill=NA, size=1)) #
  #annotate("text", x=4, y=2.5, label="I", size=6)#
#
p6 <- ggplot(data = dat) +#
  stat_density_2d(aes(x=S_Smsy_2000s, y=U_Umsy_2000s, fill = stat(level)), geom="polygon", h=bandwidth) +#
  scale_fill_distiller(palette=1, direction=1) +#
  geom_point(aes(S_Smsy_2000s, U_Umsy_2000s), size=2.5,alpha=0.45,shape=16) +#
  scale_x_continuous(name=bquote(" S/"* S[MSY]),limits = c(0,4), position = "bottom")+#
  scale_y_continuous("",limits = c(0,2.5),labels = NULL)+#
  geom_vline(xintercept=1)+#
  geom_hline(yintercept=1)+#
  theme_bw()+#
  theme(panel.background = element_blank(),panel.grid = element_blank(), #
        plot.margin = unit(c(0,0.2,0.2,0), "lines"), legend.position="none",#
        panel.border = element_rect(colour = "black", fill=NA, size=1)) #
  #annotate("text", x=2.5, y=2.5,   label= "Fraser River",size=5)+#
  #annotate("text", x=4, y=2.5, label="J", size=6)#
#
p7 <- ggplot(data=dat) +#
  geom_density(aes(x=S_Smsy_1980s, group=system,fill=system),alpha=0.65, adjust=3, linetype="dashed")+ #
  geom_density(aes(x=S_Smsy_2000s, group=system,fill=system),alpha=0.45, adjust=3)+ #
  scale_fill_manual(values=c("#104E8B"))+#
  scale_x_continuous(limits = c(0,4))+#
  coord_cartesian(ylim=c(0,1.2))+#
  theme(panel.background = element_blank(),axis.text = element_blank(), #
        axis.ticks=element_blank(),axis.title=element_blank())+#
  theme(legend.position="none",plot.margin = unit(c(0,0.2,2,.2), "lines"))+#
  geom_vline(xintercept=1) +#
  # #annotate("text", x=3, y=0.7, label= "S/Smsy", size=4)+#
  #annotate("text", x=4, y=1.1, label="L", size=6)#
p8 <- ggplot(data=dat) +#
  geom_density(aes(x=U_Umsy_1980s, group=system,fill=system),alpha=0.65, adjust=3, linetype="dashed")+ #
  geom_density(aes(x=U_Umsy_2000s, group=system,fill=system),alpha=0.45, adjust=3)+ #
  scale_fill_manual(values=c("#104E8B"))+#
  coord_flip(ylim=c(0,1.5))+#
  # coord_cartesian(ylim=c(0,1.2))+#
  scale_x_continuous(limits = c(0,2.5))+#
  theme(panel.background = element_blank(),axis.text = element_blank(), #
        axis.ticks=element_blank(),axis.title=element_blank())+#
  theme(legend.position="none",plot.margin = unit(c(0,0.2,2,.2), "lines"))+#
  geom_vline(xintercept=1) +#
  # #annotate("text", x=2, y=1.2, label= "U/Umsy", size=4)+#
  #annotate("text", x=2.3, y=1.5, label="K", size=6)#
# pdf("AllSystems_12panel.pdf", width=11, height=8)#
# grid.arrange(p1,p2,p3,p4,p5,p6,p7,p8,p9,p10,p11,p12,#
#              layout_matrix=rbind(c(1,2,3,4), c(5,6,7,8), c(9,10,11,12)))#
# dev.off()#
# #
# layout.mat <- matrix(c(1,1,2,2,3,NA,#
#                        1,1,2,2,NA,4,#
#                        5,5,6,6,7,NA,#
#                        5,5,6,6,NA,8,#
#                        9,9,10,10,11,NA,#
#                        9,9,10,10,NA,12), nrow=6, byrow=TRUE)#
#
layout.mat <- matrix(c(1,1,2,2,3,#
                       1,1,2,2,4,#
                       5,5,6,6,7,#
                       5,5,6,6,8,#
                       9,9,10,10,11,#
                       9,9,10,10,12), nrow=6, byrow=TRUE)#
pdf(paste("AllSystems_12panel_", yr.range, "yrs_11.27.2019.pdf", sep=""),#
    width=7, height=8.5) # REDUCE PDF WIDTH#
grid.arrange(p1,p2,p4,p3,p9,p10,p12,p11,p5,p6,p8,p7,#
             layout_matrix=layout.mat)#
              # , labels = c("A", "B", "C", "D", "E", "F", "G", "H"))#
             # labels=c("A", "")) # ADD THE LABELS HERE!#
dev.off()
bandwidth = c(0.8,.8)#
# bandwidth feels super arbitrary -- where it basically sets how tight the #
# contours are around the points, the first one sets in the x direction and the#
# second in the y direction (though they seem to interact)... as soon as the #
# first element jumps to 0.9, we start to get the weird splits in the Skeena#
# 2000s plot... c(0.8, 1) seems to be the closest to what we had before, but#
# without the overstretching in the Skeena plot...#
# CHANGE: since we reduced the y axis from c(0,4) to c(0,2.5) this changed#
# to c(0.8, 0.8)#
#
#############
### BBay ####
#############
dat = all.dat[all.dat$system==systems[1],]#
colors <- colorRampPalette(c("white", "#458B74", "#2F4F4F"))(10)#
p1 <- ggplot(data = dat) +#
  stat_density_2d(aes(x=S_Smsy_1980s, y=U_Umsy_1980s, fill = stat(level)), geom="polygon", h=bandwidth) +#
  scale_fill_distiller(palette=12, direction=1) +#
  scale_x_continuous("",limits = c(0,4),labels=rep("",5))+#
  scale_y_continuous(name=bquote(" U/ "* U[MSY]), limits = c(0,2.5)) +#
  geom_vline(xintercept=1) +#
  geom_hline(yintercept=1) +#
  geom_point(aes(x=S_Smsy_1980s, y=U_Umsy_1980s), size=2.5,alpha=0.45,shape=16) +#
  theme_bw() +#
  theme(panel.background = element_blank(),panel.grid = element_blank(), #
        plot.margin = unit(c(0,0.2,0.2,0), "lines"), legend.position="none",#
        panel.border = element_rect(colour = "black", fill=NA, size=1)) #
  ##annotate("text", x=0.2, y=2.5, label= "1980s",size=5) +#
  ##annotate("text", x=-0.01, y=2.5, label="A", size=6)#
#
p2 <- ggplot(data = dat) +#
  stat_density_2d(aes(x=S_Smsy_2000s, y=U_Umsy_2000s, fill = stat(level)), geom="polygon", h=bandwidth) +#
  scale_fill_distiller(palette=12, direction=1) +#
  geom_point(aes(S_Smsy_2000s, U_Umsy_2000s), size=2.5,alpha=0.45,shape=16) +#
  scale_x_continuous("",limits = c(0,4),labels=rep("",5))+#
  scale_y_continuous("",limits = c(0,2.5),labels = NULL)+#
  geom_vline(xintercept=1)+#
  geom_hline(yintercept=1)+#
  theme_bw()+#
  theme(panel.background = element_blank(),panel.grid = element_blank(), #
        plot.margin = unit(c(0,0.2,0.2,0), "lines"), legend.position="none",#
        panel.border = element_rect(colour = "black", fill=NA, size=1)) #
  #annotate("text", x=0.2, y=2.5,   label= "2000s",size=5)+#
  #annotate("text", x=2.5, y=2.5,   label= "Bristol Bay",size=5)+#
  #annotate("text", x=4, y=2.5, label="B", size=6)#
p3 <- ggplot(data=dat) +#
  geom_density(aes(x=S_Smsy_1980s, group=system,fill=system),alpha=0.65, adjust=3, linetype="dashed")+ #
  geom_density(aes(x=S_Smsy_2000s, group=system,fill=system),alpha=0.45, adjust=3)+ #
  scale_fill_manual(values=c("#5D478B"))+#
  scale_x_continuous(limits = c(0,4))+#
  coord_cartesian(ylim=c(0,1.2))+#
  theme(panel.background = element_blank(),axis.text = element_blank(), #
        axis.ticks=element_blank(),axis.title=element_blank())+#
  theme(legend.position="none",plot.margin = unit(c(0,0.2,2,.2), "lines"))+#
  geom_vline(xintercept=1) #
  #annotate("text", x=3, y=0.7, label= "S/Smsy", size=4)+#
  #annotate("text", x=4, y=1.1, label="D", size=6)#
#
p4 <- ggplot(data=dat) +#
  geom_density(aes(x=U_Umsy_1980s, group=system,fill=system),alpha=0.65, adjust=3, linetype="dashed")+ #
  geom_density(aes(x=U_Umsy_2000s, group=system,fill=system),alpha=0.45, adjust=3)+ #
  scale_fill_manual(values=c("#5D478B"))+#
  coord_flip(ylim=c(0,1.5))+#
  # coord_cartesian()+#
  scale_x_continuous(name=bquote(" U/ "* U[MSY]),limits = c(0,2.5)) +#
  theme(panel.background = element_blank(),axis.text = element_blank(), #
        axis.ticks=element_blank(),axis.title=element_blank())+#
  theme(legend.position="none",plot.margin = unit(c(0,0.2,2,.2), "lines"))+#
  geom_vline(xintercept=1) #
  #annotate("text", x=2, y=1.2, label= "U/Umsy", size=4)+#
  #annotate("text", x=2.3, y=1.5, label="C", size=6)#
###############
### Skeena ####
###############
dat = all.dat[all.dat$system==systems[3],]#
#
p9 <- ggplot(data = dat) +#
  stat_density_2d(aes(x=S_Smsy_1980s, y=U_Umsy_1980s, fill = stat(level)), geom = "polygon", h=bandwidth) +#
  scale_fill_distiller(palette=2, direction=1) +#
  geom_point(aes(S_Smsy_1980s, U_Umsy_1980s), size=2.5,alpha=0.45, shape=16) +#
  scale_x_continuous("",limits = c(0,4),labels=rep("",5))+#
  scale_y_continuous(name=bquote(" U/ "* U[MSY]),limits = c(0,2.5))+#
  geom_vline(xintercept=1)+#
  geom_hline(yintercept=1)+#
  theme_bw()+#
  theme(panel.background = element_blank(),panel.grid = element_blank(), #
        plot.margin = unit(c(0,0.2,0.2,0), "lines"), legend.position="none",#
        panel.border = element_rect(colour = "black", fill=NA, size=1)) #
  #annotate("text", x=4, y=2.5, label="E", size=6)#
#
p10 <- ggplot(data = dat) +#
  stat_density_2d(aes(x=S_Smsy_2000s, y=U_Umsy_2000s, fill = stat(level)), geom = "polygon", h=bandwidth) +#
  scale_fill_distiller(palette=2, direction=1) +#
  geom_point(aes(S_Smsy_2000s, U_Umsy_2000s), size=2.5,alpha=0.45,shape=16) +#
  scale_x_continuous("",limits = c(0,4),labels=rep("",5))+#
  scale_y_continuous("",limits = c(0,2.5),labels = NULL)+#
  geom_vline(xintercept=1)+#
  geom_hline(yintercept=1)+#
  theme_bw()+#
  theme(panel.background = element_blank(),panel.grid = element_blank(), #
        plot.margin = unit(c(0,0.2,0.2,0), "lines"), legend.position="none",#
        panel.border = element_rect(colour = "black", fill=NA, size=1)) #
  #annotate("text", x=2.5, y=2.5,   label= "Skeena River",size=5)+#
  #annotate("text", x=4, y=2.5, label="F", size=6)#
#
p11 <- ggplot(data=dat) +#
  geom_density(aes(x=S_Smsy_1980s, group=system,fill=system),alpha=0.65, adjust=3, linetype="dashed")+ #
  geom_density(aes(x=S_Smsy_2000s, group=system,fill=system),alpha=0.45, adjust=3)+ #
  scale_fill_manual(values=c("#2E8B57"))+#
  scale_x_continuous(name=bquote(" S/"* S[MSY]),limits = c(0,4),position = "bottom") +#
  #scale_x_continuous(limits = c(0,4))+#
  coord_cartesian(ylim=c(0,1.2))+#
  theme(panel.background = element_blank(),axis.text = element_blank(), #
        axis.ticks=element_blank(),axis.title=element_blank())+#
  theme(legend.position="none",plot.margin = unit(c(0,0.2,2,.2), "lines"))+#
  geom_vline(xintercept=1)#
  # #annotate("text", x=3, y=0.7, label= "S/Smsy", size=4)+#
  #annotate("text", x=4, y=1.1, label="H", size=6)#
#
p12 <- ggplot(data=dat) +#
  geom_density(aes(x=U_Umsy_1980s, group=system,fill=system),alpha=0.65, adjust=3, linetype="dashed")+ #
  geom_density(aes(x=U_Umsy_2000s, group=system,fill=system),alpha=0.45, adjust=3)+ #
  scale_fill_manual(values=c("#2E8B57"))+#
  coord_flip(ylim=c(0,1.5))+#
  # coord_cartesian(ylim=c(0,1.2))+#
  scale_x_continuous(limits = c(0,2.5))+#
  theme(panel.background = element_blank(),axis.text = element_blank(), #
        axis.ticks=element_blank(),axis.title=element_blank())+#
  theme(legend.position="none",plot.margin = unit(c(0,0.2,2,.2), "lines"))+#
  geom_vline(xintercept=1) #
  # #annotate("text", x=2, y=1.2, label= "U/Umsy", size=4)+#
  #annotate("text", x=2.3, y=1.5, label="G", size=6)#
###############
### Fraser ####
###############
dat = all.dat[all.dat$system==systems[2],]#
#
p5 <- ggplot(data = dat) +#
  stat_density_2d(aes(x=S_Smsy_1980s, y=U_Umsy_1980s, fill = stat(level)), geom="polygon", h=bandwidth) +#
  scale_fill_distiller(palette=1, direction=1) +#
  geom_point(aes(S_Smsy_1980s, U_Umsy_1980s), size=2.5,alpha=0.45,shape=16) +#
  scale_x_continuous(name=bquote(" S/"* S[MSY]),limits = c(0,4), position = "bottom")+#
  scale_y_continuous(name=bquote(" U/ "* U[MSY]),limits = c(0,2.5))+#
  geom_vline(xintercept=1)+#
  geom_hline(yintercept=1)+#
  theme_bw()+#
  theme(panel.background = element_blank(),panel.grid = element_blank(), #
        plot.margin = unit(c(0,0.2,0.2,0), "lines"), legend.position="none",#
        panel.border = element_rect(colour = "black", fill=NA, size=1)) #
  #annotate("text", x=4, y=2.5, label="I", size=6)#
#
p6 <- ggplot(data = dat) +#
  stat_density_2d(aes(x=S_Smsy_2000s, y=U_Umsy_2000s, fill = stat(level)), geom="polygon", h=bandwidth) +#
  scale_fill_distiller(palette=1, direction=1) +#
  geom_point(aes(S_Smsy_2000s, U_Umsy_2000s), size=2.5,alpha=0.45,shape=16) +#
  scale_x_continuous(name=bquote(" S/"* S[MSY]),limits = c(0,4), position = "bottom")+#
  scale_y_continuous("",limits = c(0,2.5),labels = NULL)+#
  geom_vline(xintercept=1)+#
  geom_hline(yintercept=1)+#
  theme_bw()+#
  theme(panel.background = element_blank(),panel.grid = element_blank(), #
        plot.margin = unit(c(0,0.2,0.2,0), "lines"), legend.position="none",#
        panel.border = element_rect(colour = "black", fill=NA, size=1)) #
  #annotate("text", x=2.5, y=2.5,   label= "Fraser River",size=5)+#
  #annotate("text", x=4, y=2.5, label="J", size=6)#
#
p7 <- ggplot(data=dat) +#
  geom_density(aes(x=S_Smsy_1980s, group=system,fill=system),alpha=0.65, adjust=3, linetype="dashed")+ #
  geom_density(aes(x=S_Smsy_2000s, group=system,fill=system),alpha=0.45, adjust=3)+ #
  scale_fill_manual(values=c("#104E8B"))+#
  scale_x_continuous(limits = c(0,4))+#
  coord_cartesian(ylim=c(0,1.2))+#
  theme(panel.background = element_blank(),axis.text = element_blank(), #
        axis.ticks=element_blank(),axis.title=element_blank())+#
  theme(legend.position="none",plot.margin = unit(c(0,0.2,2,.2), "lines"))+#
  geom_vline(xintercept=1) #
  # #annotate("text", x=3, y=0.7, label= "S/Smsy", size=4)+#
  #annotate("text", x=4, y=1.1, label="L", size=6)#
p8 <- ggplot(data=dat) +#
  geom_density(aes(x=U_Umsy_1980s, group=system,fill=system),alpha=0.65, adjust=3, linetype="dashed")+ #
  geom_density(aes(x=U_Umsy_2000s, group=system,fill=system),alpha=0.45, adjust=3)+ #
  scale_fill_manual(values=c("#104E8B"))+#
  coord_flip(ylim=c(0,1.5))+#
  # coord_cartesian(ylim=c(0,1.2))+#
  scale_x_continuous(limits = c(0,2.5))+#
  theme(panel.background = element_blank(),axis.text = element_blank(), #
        axis.ticks=element_blank(),axis.title=element_blank())+#
  theme(legend.position="none",plot.margin = unit(c(0,0.2,2,.2), "lines"))+#
  geom_vline(xintercept=1) #
  # #annotate("text", x=2, y=1.2, label= "U/Umsy", size=4)+#
  #annotate("text", x=2.3, y=1.5, label="K", size=6)#
# pdf("AllSystems_12panel.pdf", width=11, height=8)#
# grid.arrange(p1,p2,p3,p4,p5,p6,p7,p8,p9,p10,p11,p12,#
#              layout_matrix=rbind(c(1,2,3,4), c(5,6,7,8), c(9,10,11,12)))#
# dev.off()#
# #
# layout.mat <- matrix(c(1,1,2,2,3,NA,#
#                        1,1,2,2,NA,4,#
#                        5,5,6,6,7,NA,#
#                        5,5,6,6,NA,8,#
#                        9,9,10,10,11,NA,#
#                        9,9,10,10,NA,12), nrow=6, byrow=TRUE)#
#
layout.mat <- matrix(c(1,1,2,2,3,#
                       1,1,2,2,4,#
                       5,5,6,6,7,#
                       5,5,6,6,8,#
                       9,9,10,10,11,#
                       9,9,10,10,12), nrow=6, byrow=TRUE)#
pdf(paste("AllSystems_12panel_", yr.range, "yrs_11.27.2019.pdf", sep=""),#
    width=7, height=8.5) # REDUCE PDF WIDTH#
grid.arrange(p1,p2,p4,p3,p9,p10,p12,p11,p5,p6,p8,p7,#
             layout_matrix=layout.mat)#
              # , labels = c("A", "B", "C", "D", "E", "F", "G", "H"))#
             # labels=c("A", "")) # ADD THE LABELS HERE!#
dev.off()
pdf(paste("AllSystems_12panel_", yr.range, "yrs_11.27.2019.pdf", sep=""),#
    width=6, height=6.5) # REDUCE PDF WIDTH#
grid.arrange(p1,p2,p4,p3,p9,p10,p12,p11,p5,p6,p8,p7,#
             layout_matrix=layout.mat)#
              # , labels = c("A", "B", "C", "D", "E", "F", "G", "H"))#
             # labels=c("A", "")) # ADD THE LABELS HERE!#
dev.off()
pdf(paste("AllSystems_12panel_", yr.range, "yrs_11.27.2019.pdf", sep=""),#
    width=5.5, height=6) # REDUCE PDF WIDTH#
grid.arrange(p1,p2,p4,p3,p9,p10,p12,p11,p5,p6,p8,p7,#
             layout_matrix=layout.mat)#
              # , labels = c("A", "B", "C", "D", "E", "F", "G", "H"))#
             # labels=c("A", "")) # ADD THE LABELS HERE!#
dev.off()
library(MASS)#
library(ggplot2)#
library(gridExtra)#
#
# -----------------------------------------------------------------------------#
# Panel plot for sockey systems#
# -----------------------------------------------------------------------------#
#
systems <- c("Bristol Bay", "Fraser", "Skeena")#
decades <- c("1970s", "1980s", "1990s", "2000s")#
System.all <- list()#
#
yr.range <- 10#
for(j in 1:length(systems)) {#
  temp.S <- read.csv(paste(systems[j], "_Smsy_", yr.range, "yrs.csv", sep=""), header=T)#
  colnames(temp.S) <- c("lake", "meanSmsy", "SlowerCI", "SupperCI",#
                        "S1970s", "S1980s", "S1990s", "S2000s", "SAll")#
  temp.U <- read.csv(paste(systems[j], "_Umsy_", yr.range, "yrs.csv", sep=""), header=T)#
  for(i in 1:length(decades)) {#
    S.msy.temp <- cbind(temp.S[(4+i)]/temp.S$meanSmsy,#
                        temp.S[(4+i)]/temp.S$SlowerCI,#
                        temp.S[(4+i)]/temp.S$SupperCI)#
    colnames(S.msy.temp) <- c(paste("S_Smsy_", decades[i], sep=""),#
                               paste("SLCL_", decades[i], sep=""),#
                               paste("SUCL_", decades[i], sep=""))#
    temp.S <- cbind(temp.S, S.msy.temp)#
#
    U.msy.temp <- cbind(temp.U[(4+i)]/temp.U$meanUmsy,#
                        temp.U[(4+i)]/(temp.U$lowerCI),#
                        temp.U[(4+i)]/(temp.U$upperCI))#
    colnames(U.msy.temp) <- c(paste("U_Umsy_", decades[i], sep=""),#
                              paste("ULCL_", decades[i], sep=""),#
                              paste("UUCL_", decades[i], sep=""))#
    temp.U <- cbind(temp.U, U.msy.temp)#
#
    sys.name <- rep(systems[j], nrow(temp.U))#
  }#
#
  System.all[[j]] <- cbind(system=sys.name, temp.S, temp.U)#
#
}#
#
all.dat <- do.call(rbind.data.frame, System.all)
bandwidth = c(0.8,.8)#
# bandwidth feels super arbitrary -- where it basically sets how tight the #
# contours are around the points, the first one sets in the x direction and the#
# second in the y direction (though they seem to interact)... as soon as the #
# first element jumps to 0.9, we start to get the weird splits in the Skeena#
# 2000s plot... c(0.8, 1) seems to be the closest to what we had before, but#
# without the overstretching in the Skeena plot...#
# CHANGE: since we reduced the y axis from c(0,4) to c(0,2.5) this changed#
# to c(0.8, 0.8)#
#
#############
### BBay ####
#############
dat = all.dat[all.dat$system==systems[1],]#
colors <- colorRampPalette(c("white", "#458B74", "#2F4F4F"))(10)#
p1 <- ggplot(data = dat) +#
  stat_density_2d(aes(x=S_Smsy_1980s, y=U_Umsy_1980s, fill = stat(level)), geom="polygon", h=bandwidth) +#
  scale_fill_distiller(palette=12, direction=1) +#
  scale_x_continuous("",limits = c(0,4),labels=rep("",5))+#
  scale_y_continuous(name=bquote(" U/ "* U[MSY]), limits = c(0,2.5)) +#
  geom_vline(xintercept=1) +#
  geom_hline(yintercept=1) +#
  geom_point(aes(x=S_Smsy_1980s, y=U_Umsy_1980s), size=2.5,alpha=0.45,shape=16) +#
  theme_bw() +#
  theme(panel.background = element_blank(),panel.grid = element_blank(), #
        plot.margin = unit(c(0,0.2,0.2,0), "lines"), legend.position="none",#
        panel.border = element_rect(colour = "black", fill=NA, size=1)) #
  ##annotate("text", x=0.2, y=2.5, label= "1980s",size=5) +#
  ##annotate("text", x=-0.01, y=2.5, label="A", size=6)#
#
p2 <- ggplot(data = dat) +#
  stat_density_2d(aes(x=S_Smsy_2000s, y=U_Umsy_2000s, fill = stat(level)), geom="polygon", h=bandwidth) +#
  scale_fill_distiller(palette=12, direction=1) +#
  geom_point(aes(S_Smsy_2000s, U_Umsy_2000s), size=2.5,alpha=0.45,shape=16) +#
  scale_x_continuous("",limits = c(0,4),labels=rep("",5))+#
  scale_y_continuous("",limits = c(0,2.5),labels = NULL)+#
  geom_vline(xintercept=1)+#
  geom_hline(yintercept=1)+#
  theme_bw()+#
  theme(panel.background = element_blank(),panel.grid = element_blank(), #
        plot.margin = unit(c(0,0.2,0.2,0), "lines"), legend.position="none",#
        panel.border = element_rect(colour = "black", fill=NA, size=1)) #
  #annotate("text", x=0.2, y=2.5,   label= "2000s",size=5)+#
  #annotate("text", x=2.5, y=2.5,   label= "Bristol Bay",size=5)+#
  #annotate("text", x=4, y=2.5, label="B", size=6)#
p3 <- ggplot(data=dat) +#
  geom_density(aes(x=S_Smsy_1980s, group=system,fill=system),alpha=0.65, adjust=3, linetype="dashed")+ #
  geom_density(aes(x=S_Smsy_2000s, group=system,fill=system),alpha=0.45, adjust=3)+ #
  scale_fill_manual(values=c("#5D478B"))+#
  scale_x_continuous(limits = c(0,4))+#
  coord_cartesian(ylim=c(0,1.2))+#
  theme(panel.background = element_blank(),axis.text = element_blank(), #
        axis.ticks=element_blank(),axis.title=element_blank())+#
  theme(legend.position="none",plot.margin = unit(c(0,0.2,2,.2), "lines"))+#
  geom_vline(xintercept=1) #
  #annotate("text", x=3, y=0.7, label= "S/Smsy", size=4)+#
  #annotate("text", x=4, y=1.1, label="D", size=6)#
#
p4 <- ggplot(data=dat) +#
  geom_density(aes(x=U_Umsy_1980s, group=system,fill=system),alpha=0.65, adjust=3, linetype="dashed")+ #
  geom_density(aes(x=U_Umsy_2000s, group=system,fill=system),alpha=0.45, adjust=3)+ #
  scale_fill_manual(values=c("#5D478B"))+#
  coord_flip(ylim=c(0,1.5))+#
  # coord_cartesian()+#
  scale_x_continuous(name=bquote(" U/ "* U[MSY]),limits = c(0,2.5)) +#
  theme(panel.background = element_blank(),axis.text = element_blank(), #
        axis.ticks=element_blank(),axis.title=element_blank())+#
  theme(legend.position="none",plot.margin = unit(c(0,0.2,2,.2), "lines"))+#
  geom_vline(xintercept=1) #
  #annotate("text", x=2, y=1.2, label= "U/Umsy", size=4)+#
  #annotate("text", x=2.3, y=1.5, label="C", size=6)#
###############
### Skeena ####
###############
dat = all.dat[all.dat$system==systems[3],]#
#
p9 <- ggplot(data = dat) +#
  stat_density_2d(aes(x=S_Smsy_1980s, y=U_Umsy_1980s, fill = stat(level)), geom = "polygon", h=bandwidth) +#
  scale_fill_distiller(palette=2, direction=1) +#
  geom_point(aes(S_Smsy_1980s, U_Umsy_1980s), size=2.5,alpha=0.45, shape=16) +#
  scale_x_continuous("",limits = c(0,4),labels=rep("",5))+#
  scale_y_continuous(name=bquote(" U/ "* U[MSY]),limits = c(0,2.5))+#
  geom_vline(xintercept=1)+#
  geom_hline(yintercept=1)+#
  theme_bw()+#
  theme(panel.background = element_blank(),panel.grid = element_blank(), #
        plot.margin = unit(c(0,0.2,0.2,0), "lines"), legend.position="none",#
        panel.border = element_rect(colour = "black", fill=NA, size=1)) #
  #annotate("text", x=4, y=2.5, label="E", size=6)#
#
p10 <- ggplot(data = dat) +#
  stat_density_2d(aes(x=S_Smsy_2000s, y=U_Umsy_2000s, fill = stat(level)), geom = "polygon", h=bandwidth) +#
  scale_fill_distiller(palette=2, direction=1) +#
  geom_point(aes(S_Smsy_2000s, U_Umsy_2000s), size=2.5,alpha=0.45,shape=16) +#
  scale_x_continuous("",limits = c(0,4),labels=rep("",5))+#
  scale_y_continuous("",limits = c(0,2.5),labels = NULL)+#
  geom_vline(xintercept=1)+#
  geom_hline(yintercept=1)+#
  theme_bw()+#
  theme(panel.background = element_blank(),panel.grid = element_blank(), #
        plot.margin = unit(c(0,0.2,0.2,0), "lines"), legend.position="none",#
        panel.border = element_rect(colour = "black", fill=NA, size=1)) #
  #annotate("text", x=2.5, y=2.5,   label= "Skeena River",size=5)+#
  #annotate("text", x=4, y=2.5, label="F", size=6)#
#
p11 <- ggplot(data=dat) +#
  geom_density(aes(x=S_Smsy_1980s, group=system,fill=system),alpha=0.65, adjust=3, linetype="dashed")+ #
  geom_density(aes(x=S_Smsy_2000s, group=system,fill=system),alpha=0.45, adjust=3)+ #
  scale_fill_manual(values=c("#2E8B57"))+#
  scale_x_continuous(name=bquote(" S/"* S[MSY]),limits = c(0,4),position = "bottom") +#
  #scale_x_continuous(limits = c(0,4))+#
  coord_cartesian(ylim=c(0,1.2))+#
  theme(panel.background = element_blank(),axis.text = element_blank(), #
        axis.ticks=element_blank(),axis.title=element_blank())+#
  theme(legend.position="none",plot.margin = unit(c(0,0.2,2,.2), "lines"))+#
  geom_vline(xintercept=1)#
  # #annotate("text", x=3, y=0.7, label= "S/Smsy", size=4)+#
  #annotate("text", x=4, y=1.1, label="H", size=6)#
#
p12 <- ggplot(data=dat) +#
  geom_density(aes(x=U_Umsy_1980s, group=system,fill=system),alpha=0.65, adjust=3, linetype="dashed")+ #
  geom_density(aes(x=U_Umsy_2000s, group=system,fill=system),alpha=0.45, adjust=3)+ #
  scale_fill_manual(values=c("#2E8B57"))+#
  coord_flip(ylim=c(0,1.5))+#
  # coord_cartesian(ylim=c(0,1.2))+#
  scale_x_continuous(limits = c(0,2.5))+#
  theme(panel.background = element_blank(),axis.text = element_blank(), #
        axis.ticks=element_blank(),axis.title=element_blank())+#
  theme(legend.position="none",plot.margin = unit(c(0,0.2,2,.2), "lines"))+#
  geom_vline(xintercept=1) #
  # #annotate("text", x=2, y=1.2, label= "U/Umsy", size=4)+#
  #annotate("text", x=2.3, y=1.5, label="G", size=6)#
###############
### Fraser ####
###############
dat = all.dat[all.dat$system==systems[2],]#
#
p5 <- ggplot(data = dat) +#
  stat_density_2d(aes(x=S_Smsy_1980s, y=U_Umsy_1980s, fill = stat(level)), geom="polygon", h=bandwidth) +#
  scale_fill_distiller(palette=1, direction=1) +#
  geom_point(aes(S_Smsy_1980s, U_Umsy_1980s), size=2.5,alpha=0.45,shape=16) +#
  scale_x_continuous(name=bquote(" S/"* S[MSY]),limits = c(0,4), position = "bottom")+#
  scale_y_continuous(name=bquote(" U/ "* U[MSY]),limits = c(0,2.5))+#
  geom_vline(xintercept=1)+#
  geom_hline(yintercept=1)+#
  theme_bw()+#
  theme(panel.background = element_blank(),panel.grid = element_blank(), #
        plot.margin = unit(c(0,0.2,0.2,0), "lines"), legend.position="none",#
        panel.border = element_rect(colour = "black", fill=NA, size=1)) #
  #annotate("text", x=4, y=2.5, label="I", size=6)#
#
p6 <- ggplot(data = dat) +#
  stat_density_2d(aes(x=S_Smsy_2000s, y=U_Umsy_2000s, fill = stat(level)), geom="polygon", h=bandwidth) +#
  scale_fill_distiller(palette=1, direction=1) +#
  geom_point(aes(S_Smsy_2000s, U_Umsy_2000s), size=2.5,alpha=0.45,shape=16) +#
  scale_x_continuous(name=bquote(" S/"* S[MSY]),limits = c(0,4), position = "bottom")+#
  scale_y_continuous("",limits = c(0,2.5),labels = NULL)+#
  geom_vline(xintercept=1)+#
  geom_hline(yintercept=1)+#
  theme_bw()+#
  theme(panel.background = element_blank(),panel.grid = element_blank(), #
        plot.margin = unit(c(0,0.2,0.2,0), "lines"), legend.position="none",#
        panel.border = element_rect(colour = "black", fill=NA, size=1)) #
  #annotate("text", x=2.5, y=2.5,   label= "Fraser River",size=5)+#
  #annotate("text", x=4, y=2.5, label="J", size=6)#
#
p7 <- ggplot(data=dat) +#
  geom_density(aes(x=S_Smsy_1980s, group=system,fill=system),alpha=0.65, adjust=3, linetype="dashed")+ #
  geom_density(aes(x=S_Smsy_2000s, group=system,fill=system),alpha=0.45, adjust=3)+ #
  scale_fill_manual(values=c("#104E8B"))+#
  scale_x_continuous(limits = c(0,4))+#
  coord_cartesian(ylim=c(0,1.2))+#
  theme(panel.background = element_blank(),axis.text = element_blank(), #
        axis.ticks=element_blank(),axis.title=element_blank())+#
  theme(legend.position="none",plot.margin = unit(c(0,0.2,2,.2), "lines"))+#
  geom_vline(xintercept=1) #
  # #annotate("text", x=3, y=0.7, label= "S/Smsy", size=4)+#
  #annotate("text", x=4, y=1.1, label="L", size=6)#
p8 <- ggplot(data=dat) +#
  geom_density(aes(x=U_Umsy_1980s, group=system,fill=system),alpha=0.65, adjust=3, linetype="dashed")+ #
  geom_density(aes(x=U_Umsy_2000s, group=system,fill=system),alpha=0.45, adjust=3)+ #
  scale_fill_manual(values=c("#104E8B"))+#
  coord_flip(ylim=c(0,1.5))+#
  # coord_cartesian(ylim=c(0,1.2))+#
  scale_x_continuous(limits = c(0,2.5))+#
  theme(panel.background = element_blank(),axis.text = element_blank(), #
        axis.ticks=element_blank(),axis.title=element_blank())+#
  theme(legend.position="none",plot.margin = unit(c(0,0.2,2,.2), "lines"))+#
  geom_vline(xintercept=1) #
  # #annotate("text", x=2, y=1.2, label= "U/Umsy", size=4)+#
  #annotate("text", x=2.3, y=1.5, label="K", size=6)#
# pdf("AllSystems_12panel.pdf", width=11, height=8)#
# grid.arrange(p1,p2,p3,p4,p5,p6,p7,p8,p9,p10,p11,p12,#
#              layout_matrix=rbind(c(1,2,3,4), c(5,6,7,8), c(9,10,11,12)))#
# dev.off()#
# #
# layout.mat <- matrix(c(1,1,2,2,3,NA,#
#                        1,1,2,2,NA,4,#
#                        5,5,6,6,7,NA,#
#                        5,5,6,6,NA,8,#
#                        9,9,10,10,11,NA,#
#                        9,9,10,10,NA,12), nrow=6, byrow=TRUE)#
#
layout.mat <- matrix(c(1,1,2,2,3,#
                       1,1,2,2,4,#
                       5,5,6,6,7,#
                       5,5,6,6,8,#
                       9,9,10,10,11,#
                       9,9,10,10,12), nrow=6, byrow=TRUE)
grid.arrange(p1,p2,p4,p3,p9,p10,p12,p11,p5,p6,p8,p7,#
             layout_matrix=layout.mat)
pdf(paste("AllSystems_12panel_", yr.range, "yrs_1.16.2020.pdf", sep=""),#
    width=5.5, height=6) # REDUCE PDF WIDTH#
grid.arrange(p1,p2,p4,p3,p9,p10,p12,p11,p5,p6,p8,p7,#
             layout_matrix=layout.mat)#
              # , labels = c("A", "B", "C", "D", "E", "F", "G", "H"))#
             # labels=c("A", "")) # ADD THE LABELS HERE!#
dev.off()
systems <- c("Bristol Bay", "Fraser", "Skeena")#
decades <- c("1970s", "1980s", "1990s", "2000s")#
System.all <- list()#
#
yr.range <- 10#
#
# error if Cultus lake is in the csv for alpha / beta parameters or if Skeena#
# has Azuklotz#
#
for(j in 1:length(systems)) {#
  temp.S <- read.csv(paste(systems[j], "_Smsy_", yr.range, "yrs.csv", sep=""), header=T)#
  colnames(temp.S) <- c("lake", "meanSmsy", "SlowerCI", "SupperCI",#
                        "S1970s", "S1980s", "S1990s", "S2000s", "SAll")#
  temp.U <- read.csv(paste(systems[j], "_Umsy_", yr.range, "yrs.csv", sep=""), header=T)#
  temp.params <- read.csv(paste("../Parameter Estimation/", systems[j], "/", #
                                systems[j], "_AlphaBeta_estimates.csv", sep=""))#
  for(i in 1:length(decades)) {#
    S.msy.temp <- cbind(temp.S[(4+i)]/temp.S$meanSmsy,#
                        temp.S[(4+i)]/temp.S$SlowerCI,#
                        temp.S[(4+i)]/temp.S$SupperCI)#
    colnames(S.msy.temp) <- c(paste("S_Smsy_", decades[i], sep=""),#
                              paste("SLCL_", decades[i], sep=""),#
                              paste("SUCL_", decades[i], sep=""))#
    temp.S <- cbind(temp.S, S.msy.temp)#
    U.msy.temp <- cbind(temp.U[(4+i)]/temp.U$meanUmsy,#
                        temp.U[(4+i)]/(temp.U$lowerCI),#
                        temp.U[(4+i)]/(temp.U$upperCI))#
    colnames(U.msy.temp) <- c(paste("U_Umsy_", decades[i], sep=""),#
                              paste("ULCL_", decades[i], sep=""),#
                              paste("UUCL_", decades[i], sep=""))#
    temp.U <- cbind(temp.U, U.msy.temp)#
    sys.name <- rep(systems[j], nrow(temp.U))#
  }#
  if(j==2) {temp.params <- subset(temp.params, stock!="Cultus")}#
  if(j==3) {temp.params <- subset(temp.params, stock!="Azuklotz")}#
  alpha.order <- rank(temp.params$alpha)#
  System.all[[j]] <- cbind(system=sys.name, temp.S, temp.U, temp.params, #
                           alpha.order)#
}#
#
all.dat <- do.call(rbind.data.frame, System.all)
temp.params <- read.csv(paste( systems[j], "/", #
                                systems[j], "_AlphaBeta_estimates.csv", sep=""))
temp.params <- read.csv(paste(#
                                systems[j], "_AlphaBeta_estimates.csv", sep=""))
for(j in 1:length(systems)) {#
  temp.S <- read.csv(paste(systems[j], "_Smsy_", yr.range, "yrs.csv", sep=""), header=T)#
  colnames(temp.S) <- c("lake", "meanSmsy", "SlowerCI", "SupperCI",#
                        "S1970s", "S1980s", "S1990s", "S2000s", "SAll")#
  temp.U <- read.csv(paste(systems[j], "_Umsy_", yr.range, "yrs.csv", sep=""), header=T)#
  temp.params <- read.csv(paste(systems[j], "_AlphaBeta_estimates.csv", sep=""))#
  for(i in 1:length(decades)) {#
    S.msy.temp <- cbind(temp.S[(4+i)]/temp.S$meanSmsy,#
                        temp.S[(4+i)]/temp.S$SlowerCI,#
                        temp.S[(4+i)]/temp.S$SupperCI)#
    colnames(S.msy.temp) <- c(paste("S_Smsy_", decades[i], sep=""),#
                              paste("SLCL_", decades[i], sep=""),#
                              paste("SUCL_", decades[i], sep=""))#
    temp.S <- cbind(temp.S, S.msy.temp)#
    U.msy.temp <- cbind(temp.U[(4+i)]/temp.U$meanUmsy,#
                        temp.U[(4+i)]/(temp.U$lowerCI),#
                        temp.U[(4+i)]/(temp.U$upperCI))#
    colnames(U.msy.temp) <- c(paste("U_Umsy_", decades[i], sep=""),#
                              paste("ULCL_", decades[i], sep=""),#
                              paste("UUCL_", decades[i], sep=""))#
    temp.U <- cbind(temp.U, U.msy.temp)#
    sys.name <- rep(systems[j], nrow(temp.U))#
  }#
  if(j==2) {temp.params <- subset(temp.params, stock!="Cultus")}#
  if(j==3) {temp.params <- subset(temp.params, stock!="Azuklotz")}#
  alpha.order <- rank(temp.params$alpha)#
  System.all[[j]] <- cbind(system=sys.name, temp.S, temp.U, temp.params, #
                           alpha.order)#
}#
#
all.dat <- do.call(rbind.data.frame, System.all)
par(mfrow=c(3,2))#
par(mar=c(5.1, 5.1, 2.1, 15.1))#
#
for(i in c(1,3,2)) {#
dat1 = all.dat[all.dat$system==systems[i],]#
#
dat <- dat1 %>% #
  arrange(desc(SAll))#
#
col.range <- colorRampPalette(c("red", "blue"))(nrow(dat))#
# col.range <- paste(col.range, "99", sep="")#
plot(x=dat$S_Smsy_1980s, y=dat$U_Umsy_1980s, bg=col.range[dat$alpha.order], #
     cex=sqrt(dat$SAll/10000), pch=21, xlim=c(0,4), ylim=c(0,2.5), col="black",#
     xlab="S/Smsy", ylab="U/Umsy", main=systems[i], cex.axis=2, cex.lab=2, las=1,#
     cex.main=2)#
abline(h=1)#
abline(v=1)#
text(x=rep(4.2,nrow(dat)), y=seq(0,2.5,length.out=nrow(dat)),#
     labels = dat$lake, pos=4, xpd=NA, cex=2)#
#
for(j in 1:nrow(dat)) {#
  lines(x=c(dat$S_Smsy_1980s[j], 4.22),#
        y=c(dat$U_Umsy_1980s[j], seq(0,2.5,length.out=nrow(dat))[j]),#
        xpd=NA)#
}#
plot(x=dat$S_Smsy_2000s, y=dat$U_Umsy_2000s, bg=col.range[dat$alpha.order], #
     cex=sqrt(dat$SAll/10000), pch=21, xlim=c(0,4), ylim=c(0,2.5), col="black",#
     xlab="S/Smsy", ylab="", main=systems[i], cex.axis=2, cex.lab=2, las=1,#
     cex.main=2)#
abline(h=1)#
abline(v=1)#
text(x=rep(4.2,nrow(dat)), y=seq(0,2.5,length.out=nrow(dat)),#
     labels = dat$lake, pos=4, xpd=NA, cex=2)#
#
for(j in 1:nrow(dat)) {#
  lines(x=c(dat$S_Smsy_2000s[j], 4.22),#
        y=c(dat$U_Umsy_2000s[j], seq(0,2.5,length.out=nrow(dat))[j]),#
        xpd=NA)#
}  #
}
library(MASS)#
library(ggplot2)#
library(gridExtra)#
library(dplyr)
par(mfrow=c(3,2))#
par(mar=c(5.1, 5.1, 2.1, 15.1))#
#
for(i in c(1,3,2)) {#
dat1 = all.dat[all.dat$system==systems[i],]#
#
dat <- dat1 %>% #
  arrange(desc(SAll))#
#
col.range <- colorRampPalette(c("red", "blue"))(nrow(dat))#
# col.range <- paste(col.range, "99", sep="")#
plot(x=dat$S_Smsy_1980s, y=dat$U_Umsy_1980s, bg=col.range[dat$alpha.order], #
     cex=sqrt(dat$SAll/10000), pch=21, xlim=c(0,4), ylim=c(0,2.5), col="black",#
     xlab="S/Smsy", ylab="U/Umsy", main=systems[i], cex.axis=2, cex.lab=2, las=1,#
     cex.main=2)#
abline(h=1)#
abline(v=1)#
text(x=rep(4.2,nrow(dat)), y=seq(0,2.5,length.out=nrow(dat)),#
     labels = dat$lake, pos=4, xpd=NA, cex=2)#
#
for(j in 1:nrow(dat)) {#
  lines(x=c(dat$S_Smsy_1980s[j], 4.22),#
        y=c(dat$U_Umsy_1980s[j], seq(0,2.5,length.out=nrow(dat))[j]),#
        xpd=NA)#
}#
plot(x=dat$S_Smsy_2000s, y=dat$U_Umsy_2000s, bg=col.range[dat$alpha.order], #
     cex=sqrt(dat$SAll/10000), pch=21, xlim=c(0,4), ylim=c(0,2.5), col="black",#
     xlab="S/Smsy", ylab="", main=systems[i], cex.axis=2, cex.lab=2, las=1,#
     cex.main=2)#
abline(h=1)#
abline(v=1)#
text(x=rep(4.2,nrow(dat)), y=seq(0,2.5,length.out=nrow(dat)),#
     labels = dat$lake, pos=4, xpd=NA, cex=2)#
#
for(j in 1:nrow(dat)) {#
  lines(x=c(dat$S_Smsy_2000s[j], 4.22),#
        y=c(dat$U_Umsy_2000s[j], seq(0,2.5,length.out=nrow(dat))[j]),#
        xpd=NA)#
}  #
}
png("SuppMat_01.20.2020.png", width=1300, height=1300)#
par(mfrow=c(3,2))#
par(mar=c(5.1, 5.1, 2.1, 15.1))#
#
for(i in c(1,3,2)) {#
dat1 = all.dat[all.dat$system==systems[i],]#
#
dat <- dat1 %>% #
  arrange(desc(SAll))#
#
col.range <- colorRampPalette(c("red", "blue"))(nrow(dat))#
# col.range <- paste(col.range, "99", sep="")#
plot(x=dat$S_Smsy_1980s, y=dat$U_Umsy_1980s, bg=col.range[dat$alpha.order], #
     cex=sqrt(dat$SAll/10000), pch=21, xlim=c(0,4), ylim=c(0,2.5), col="black",#
     xlab="S/Smsy", ylab="U/Umsy", main=systems[i], cex.axis=2, cex.lab=2, las=1,#
     cex.main=2)#
abline(h=1)#
abline(v=1)#
text(x=rep(4.2,nrow(dat)), y=seq(0,2.5,length.out=nrow(dat)),#
     labels = dat$lake, pos=4, xpd=NA, cex=2)#
#
for(j in 1:nrow(dat)) {#
  lines(x=c(dat$S_Smsy_1980s[j], 4.22),#
        y=c(dat$U_Umsy_1980s[j], seq(0,2.5,length.out=nrow(dat))[j]),#
        xpd=NA)#
}#
plot(x=dat$S_Smsy_2000s, y=dat$U_Umsy_2000s, bg=col.range[dat$alpha.order], #
     cex=sqrt(dat$SAll/10000), pch=21, xlim=c(0,4), ylim=c(0,2.5), col="black",#
     xlab="S/Smsy", ylab="", main=systems[i], cex.axis=2, cex.lab=2, las=1,#
     cex.main=2)#
abline(h=1)#
abline(v=1)#
text(x=rep(4.2,nrow(dat)), y=seq(0,2.5,length.out=nrow(dat)),#
     labels = dat$lake, pos=4, xpd=NA, cex=2)#
#
for(j in 1:nrow(dat)) {#
  lines(x=c(dat$S_Smsy_2000s[j], 4.22),#
        y=c(dat$U_Umsy_2000s[j], seq(0,2.5,length.out=nrow(dat))[j]),#
        xpd=NA)#
}  #
}#
dev.off()
dat
all.dat
scaled.size <- dat$SAll/sum(dat$SAll)
scaled.size
scaled.size <- dat$SAll/max(dat$SAll)
scaled.size
sqrt(scaled.size)
png("SuppMat_01.20.2020.png", width=1300, height=1300)#
par(mfrow=c(3,2))#
par(mar=c(5.1, 5.1, 2.1, 15.1))#
#
for(i in c(1,3,2)) {#
dat1 = all.dat[all.dat$system==systems[i],]#
#
dat <- dat1 %>% #
  arrange(desc(SAll))#
#
col.range <- colorRampPalette(c("red", "blue"))(nrow(dat))#
# col.range <- paste(col.range, "99", sep="")#
scaled.size <- sqrt(dat$SAll/max(dat$SAll))#
#
plot(x=dat$S_Smsy_1980s, y=dat$U_Umsy_1980s, bg=col.range[dat$alpha.order], #
     cex= scaled.size, pch=21, xlim=c(0,4), ylim=c(0,2.5), col="black",#
     xlab="S/Smsy", ylab="U/Umsy", main=systems[i], cex.axis=2, cex.lab=2, las=1,#
     cex.main=2)#
abline(h=1)#
abline(v=1)#
text(x=rep(4.2,nrow(dat)), y=seq(0,2.5,length.out=nrow(dat)),#
     labels = dat$lake, pos=4, xpd=NA, cex=2)#
#
for(j in 1:nrow(dat)) {#
  lines(x=c(dat$S_Smsy_1980s[j], 4.22),#
        y=c(dat$U_Umsy_1980s[j], seq(0,2.5,length.out=nrow(dat))[j]),#
        xpd=NA)#
}#
plot(x=dat$S_Smsy_2000s, y=dat$U_Umsy_2000s, bg=col.range[dat$alpha.order], #
     cex=sqrt(dat$SAll/10000), pch=21, xlim=c(0,4), ylim=c(0,2.5), col="black",#
     xlab="S/Smsy", ylab="", main=systems[i], cex.axis=2, cex.lab=2, las=1,#
     cex.main=2)#
abline(h=1)#
abline(v=1)#
text(x=rep(4.2,nrow(dat)), y=seq(0,2.5,length.out=nrow(dat)),#
     labels = dat$lake, pos=4, xpd=NA, cex=2)#
#
for(j in 1:nrow(dat)) {#
  lines(x=c(dat$S_Smsy_2000s[j], 4.22),#
        y=c(dat$U_Umsy_2000s[j], seq(0,2.5,length.out=nrow(dat))[j]),#
        xpd=NA)#
}  #
}#
dev.off()
png("SuppMat_01.20.2020.png", width=1300, height=1300)#
par(mfrow=c(3,2))#
par(mar=c(5.1, 5.1, 2.1, 15.1))#
#
for(i in c(1,3,2)) {#
dat1 = all.dat[all.dat$system==systems[i],]#
#
dat <- dat1 %>% #
  arrange(desc(SAll))#
#
col.range <- colorRampPalette(c("red", "blue"))(nrow(dat))#
# col.range <- paste(col.range, "99", sep="")#
scaled.size <- sqrt(dat$SAll/max(dat$SAll))#
#
plot(x=dat$S_Smsy_1980s, y=dat$U_Umsy_1980s, bg=col.range[dat$alpha.order], #
     cex= scaled.size, pch=21, xlim=c(0,4), ylim=c(0,2.5), col="black",#
     xlab="S/Smsy", ylab="U/Umsy", main=systems[i], cex.axis=2, cex.lab=2, las=1,#
     cex.main=2)#
abline(h=1)#
abline(v=1)#
text(x=rep(4.2,nrow(dat)), y=seq(0,2.5,length.out=nrow(dat)),#
     labels = dat$lake, pos=4, xpd=NA, cex=2)#
#
for(j in 1:nrow(dat)) {#
  lines(x=c(dat$S_Smsy_1980s[j], 4.22),#
        y=c(dat$U_Umsy_1980s[j], seq(0,2.5,length.out=nrow(dat))[j]),#
        xpd=NA)#
}#
plot(x=dat$S_Smsy_2000s, y=dat$U_Umsy_2000s, bg=col.range[dat$alpha.order], #
     cex= scaled.size, pch=21, xlim=c(0,4), ylim=c(0,2.5), col="black",#
     xlab="S/Smsy", ylab="", main=systems[i], cex.axis=2, cex.lab=2, las=1,#
     cex.main=2)#
abline(h=1)#
abline(v=1)#
text(x=rep(4.2,nrow(dat)), y=seq(0,2.5,length.out=nrow(dat)),#
     labels = dat$lake, pos=4, xpd=NA, cex=2)#
#
for(j in 1:nrow(dat)) {#
  lines(x=c(dat$S_Smsy_2000s[j], 4.22),#
        y=c(dat$U_Umsy_2000s[j], seq(0,2.5,length.out=nrow(dat))[j]),#
        xpd=NA)#
}  #
}#
dev.off()
png("SuppMat_01.20.2020.png", width=8, height=8, units = "in")#
par(mfrow=c(3,2))#
par(mar=c(5.1, 5.1, 2.1, 15.1))#
#
for(i in c(1,3,2)) {#
dat1 = all.dat[all.dat$system==systems[i],]#
#
dat <- dat1 %>% #
  arrange(desc(SAll))#
#
col.range <- colorRampPalette(c("red", "blue"))(nrow(dat))#
# col.range <- paste(col.range, "99", sep="")#
scaled.size <- sqrt(dat$SAll/max(dat$SAll))#
#
plot(x=dat$S_Smsy_1980s, y=dat$U_Umsy_1980s, bg=col.range[dat$alpha.order], #
     cex= scaled.size, pch=21, xlim=c(0,4), ylim=c(0,2.5), col="black",#
     xlab="S/Smsy", ylab="U/Umsy", main=systems[i], cex.axis=2, cex.lab=2, las=1,#
     cex.main=2)#
abline(h=1)#
abline(v=1)#
text(x=rep(4.2,nrow(dat)), y=seq(0,2.5,length.out=nrow(dat)),#
     labels = dat$lake, pos=4, xpd=NA, cex=2)#
#
for(j in 1:nrow(dat)) {#
  lines(x=c(dat$S_Smsy_1980s[j], 4.22),#
        y=c(dat$U_Umsy_1980s[j], seq(0,2.5,length.out=nrow(dat))[j]),#
        xpd=NA)#
}#
plot(x=dat$S_Smsy_2000s, y=dat$U_Umsy_2000s, bg=col.range[dat$alpha.order], #
     cex= scaled.size, pch=21, xlim=c(0,4), ylim=c(0,2.5), col="black",#
     xlab="S/Smsy", ylab="", main=systems[i], cex.axis=2, cex.lab=2, las=1,#
     cex.main=2)#
abline(h=1)#
abline(v=1)#
text(x=rep(4.2,nrow(dat)), y=seq(0,2.5,length.out=nrow(dat)),#
     labels = dat$lake, pos=4, xpd=NA, cex=2)#
#
for(j in 1:nrow(dat)) {#
  lines(x=c(dat$S_Smsy_2000s[j], 4.22),#
        y=c(dat$U_Umsy_2000s[j], seq(0,2.5,length.out=nrow(dat))[j]),#
        xpd=NA)#
}  #
}#
dev.off()
png("SuppMat_01.20.2020.png", width=8, height=8, units = "in", res = 500)#
par(mfrow=c(3,2))#
par(mar=c(5.1, 5.1, 2.1, 15.1))#
#
for(i in c(1,3,2)) {#
dat1 = all.dat[all.dat$system==systems[i],]#
#
dat <- dat1 %>% #
  arrange(desc(SAll))#
#
col.range <- colorRampPalette(c("red", "blue"))(nrow(dat))#
# col.range <- paste(col.range, "99", sep="")#
scaled.size <- sqrt(dat$SAll/max(dat$SAll))#
#
plot(x=dat$S_Smsy_1980s, y=dat$U_Umsy_1980s, bg=col.range[dat$alpha.order], #
     cex= scaled.size, pch=21, xlim=c(0,4), ylim=c(0,2.5), col="black",#
     xlab="S/Smsy", ylab="U/Umsy", main=systems[i], cex.axis=2, cex.lab=2, las=1,#
     cex.main=2)#
abline(h=1)#
abline(v=1)#
text(x=rep(4.2,nrow(dat)), y=seq(0,2.5,length.out=nrow(dat)),#
     labels = dat$lake, pos=4, xpd=NA, cex=2)#
#
for(j in 1:nrow(dat)) {#
  lines(x=c(dat$S_Smsy_1980s[j], 4.22),#
        y=c(dat$U_Umsy_1980s[j], seq(0,2.5,length.out=nrow(dat))[j]),#
        xpd=NA)#
}#
plot(x=dat$S_Smsy_2000s, y=dat$U_Umsy_2000s, bg=col.range[dat$alpha.order], #
     cex= scaled.size, pch=21, xlim=c(0,4), ylim=c(0,2.5), col="black",#
     xlab="S/Smsy", ylab="", main=systems[i], cex.axis=2, cex.lab=2, las=1,#
     cex.main=2)#
abline(h=1)#
abline(v=1)#
text(x=rep(4.2,nrow(dat)), y=seq(0,2.5,length.out=nrow(dat)),#
     labels = dat$lake, pos=4, xpd=NA, cex=2)#
#
for(j in 1:nrow(dat)) {#
  lines(x=c(dat$S_Smsy_2000s[j], 4.22),#
        y=c(dat$U_Umsy_2000s[j], seq(0,2.5,length.out=nrow(dat))[j]),#
        xpd=NA)#
}  #
}#
dev.off()
png("SuppMat_01.20.2020.png", width=8, height=8, units = "in", res = 500)#
par(mfrow=c(3,2))#
par(mar=c(5.1, 5.1, 2.1, 15.1))#
#
for(i in c(1,3,2)) {#
dat1 = all.dat[all.dat$system==systems[i],]#
#
dat <- dat1 %>% #
  arrange(desc(SAll))#
#
col.range <- colorRampPalette(c("red", "blue"))(nrow(dat))#
# col.range <- paste(col.range, "99", sep="")#
scaled.size <- sqrt(dat$SAll/max(dat$SAll))#
#
plot(x=dat$S_Smsy_1980s, y=dat$U_Umsy_1980s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*3, pch=21, xlim=c(0,4), ylim=c(0,2.5), col="black",#
     xlab="S/Smsy", ylab="U/Umsy", main=systems[i], cex.axis=1, cex.lab=1, las=1,#
     cex.main=2)#
abline(h=1)#
abline(v=1)#
text(x=rep(4.2,nrow(dat)), y=seq(0,2.5,length.out=nrow(dat)),#
     labels = dat$lake, pos=4, xpd=NA, cex=1)#
#
for(j in 1:nrow(dat)) {#
  lines(x=c(dat$S_Smsy_1980s[j], 4.22),#
        y=c(dat$U_Umsy_1980s[j], seq(0,2.5,length.out=nrow(dat))[j]),#
        xpd=NA)#
}#
plot(x=dat$S_Smsy_2000s, y=dat$U_Umsy_2000s, bg=col.range[dat$alpha.order], #
     cex= scaled.size, pch=21, xlim=c(0,4), ylim=c(0,2.5), col="black",#
     xlab="S/Smsy", ylab="", main=systems[i], cex.axis=2, cex.lab=2, las=1,#
     cex.main=2)#
abline(h=1)#
abline(v=1)#
text(x=rep(4.2,nrow(dat)), y=seq(0,2.5,length.out=nrow(dat)),#
     labels = dat$lake, pos=4, xpd=NA, cex=2)#
#
for(j in 1:nrow(dat)) {#
  lines(x=c(dat$S_Smsy_2000s[j], 4.22),#
        y=c(dat$U_Umsy_2000s[j], seq(0,2.5,length.out=nrow(dat))[j]),#
        xpd=NA)#
}  #
}#
dev.off()
png("SuppMat_01.20.2020.png", width=8, height=8, units = "in", res = 500)#
par(mfrow=c(3,2))#
par(mar=c(5.1, 5.1, 2.1, 15.1))#
#
for(i in c(1,3,2)) {#
dat1 = all.dat[all.dat$system==systems[i],]#
#
dat <- dat1 %>% #
  arrange(desc(SAll))#
#
col.range <- colorRampPalette(c("red", "blue"))(nrow(dat))#
# col.range <- paste(col.range, "99", sep="")#
scaled.size <- sqrt(dat$SAll/max(dat$SAll))#
#
plot(x=dat$S_Smsy_1980s, y=dat$U_Umsy_1980s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*4, pch=21, xlim=c(0,4), ylim=c(0,2.5), col="black",#
     xlab="S/Smsy", ylab="U/Umsy", main=systems[i], cex.axis=1, cex.lab=1, las=1,#
     cex.main=2)#
abline(h=1)#
abline(v=1)#
text(x=rep(4.2,nrow(dat)), y=seq(0,2.5,length.out=nrow(dat)),#
     labels = dat$lake, pos=4, xpd=NA, cex=1)#
#
for(j in 1:nrow(dat)) {#
  lines(x=c(dat$S_Smsy_1980s[j], 4.22),#
        y=c(dat$U_Umsy_1980s[j], seq(0,2.5,length.out=nrow(dat))[j]),#
        xpd=NA)#
}#
plot(x=dat$S_Smsy_2000s, y=dat$U_Umsy_2000s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*5, pch=21, xlim=c(0,4), ylim=c(0,2.5), col="black",#
     xlab="S/Smsy", ylab="", main=systems[i], cex.axis=2, cex.lab=2, las=1,#
     cex.main=2)#
abline(h=1)#
abline(v=1)#
text(x=rep(4.2,nrow(dat)), y=seq(0,2.5,length.out=nrow(dat)),#
     labels = dat$lake, pos=4, xpd=NA, cex=2)#
#
for(j in 1:nrow(dat)) {#
  lines(x=c(dat$S_Smsy_2000s[j], 4.22),#
        y=c(dat$U_Umsy_2000s[j], seq(0,2.5,length.out=nrow(dat))[j]),#
        xpd=NA)#
}  #
}#
dev.off()
par(mfrow=c(3,2))#
par(mar=c(2,2,1,5))#
#
for(i in c(1,3,2)) {#
dat1 = all.dat[all.dat$system==systems[i],]#
#
dat <- dat1 %>% #
  arrange(desc(SAll))#
#
col.range <- colorRampPalette(c("red", "blue"))(nrow(dat))#
# col.range <- paste(col.range, "99", sep="")#
scaled.size <- sqrt(dat$SAll/max(dat$SAll))#
#
plot(x=dat$S_Smsy_1980s, y=dat$U_Umsy_1980s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*4, pch=21, xlim=c(0,4), ylim=c(0,2.5), col="black",#
     xlab="S/Smsy", ylab="U/Umsy", main=systems[i], cex.axis=1, cex.lab=1, las=1,#
     cex.main=2)#
abline(h=1)#
abline(v=1)#
text(x=rep(4.2,nrow(dat)), y=seq(0,2.5,length.out=nrow(dat)),#
     labels = dat$lake, pos=4, xpd=NA, cex=1)#
#
for(j in 1:nrow(dat)) {#
  lines(x=c(dat$S_Smsy_1980s[j], 4.22),#
        y=c(dat$U_Umsy_1980s[j], seq(0,2.5,length.out=nrow(dat))[j]),#
        xpd=NA)#
}#
plot(x=dat$S_Smsy_2000s, y=dat$U_Umsy_2000s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*5, pch=21, xlim=c(0,4), ylim=c(0,2.5), col="black",#
     xlab="S/Smsy", ylab="", main=systems[i], cex.axis=2, cex.lab=2, las=1,#
     cex.main=2)#
abline(h=1)#
abline(v=1)#
text(x=rep(4.2,nrow(dat)), y=seq(0,2.5,length.out=nrow(dat)),#
     labels = dat$lake, pos=4, xpd=NA, cex=2)#
#
for(j in 1:nrow(dat)) {#
  lines(x=c(dat$S_Smsy_2000s[j], 4.22),#
        y=c(dat$U_Umsy_2000s[j], seq(0,2.5,length.out=nrow(dat))[j]),#
        xpd=NA)#
}  #
}#
mtext(expression('U/U'[MSY]),2,outer=T)
par(mfrow=c(3,2))#
par(mar=c(2,2,1,5), oma=c(2,2,1,1))#
#
for(i in c(1,3,2)) {#
dat1 = all.dat[all.dat$system==systems[i],]#
#
dat <- dat1 %>% #
  arrange(desc(SAll))#
#
col.range <- colorRampPalette(c("red", "blue"))(nrow(dat))#
# col.range <- paste(col.range, "99", sep="")#
scaled.size <- sqrt(dat$SAll/max(dat$SAll))#
#
plot(x=dat$S_Smsy_1980s, y=dat$U_Umsy_1980s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*4, pch=21, xlim=c(0,4), ylim=c(0,2.5), col="black",#
     xlab="S/Smsy", ylab="U/Umsy", main=systems[i], cex.axis=1, cex.lab=1, las=1,#
     cex.main=2)#
abline(h=1)#
abline(v=1)#
text(x=rep(4.2,nrow(dat)), y=seq(0,2.5,length.out=nrow(dat)),#
     labels = dat$lake, pos=4, xpd=NA, cex=1)#
#
for(j in 1:nrow(dat)) {#
  lines(x=c(dat$S_Smsy_1980s[j], 4.22),#
        y=c(dat$U_Umsy_1980s[j], seq(0,2.5,length.out=nrow(dat))[j]),#
        xpd=NA)#
}#
plot(x=dat$S_Smsy_2000s, y=dat$U_Umsy_2000s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*5, pch=21, xlim=c(0,4), ylim=c(0,2.5), col="black",#
     xlab="S/Smsy", ylab="", main=systems[i], cex.axis=2, cex.lab=2, las=1,#
     cex.main=2)#
abline(h=1)#
abline(v=1)#
text(x=rep(4.2,nrow(dat)), y=seq(0,2.5,length.out=nrow(dat)),#
     labels = dat$lake, pos=4, xpd=NA, cex=2)#
#
for(j in 1:nrow(dat)) {#
  lines(x=c(dat$S_Smsy_2000s[j], 4.22),#
        y=c(dat$U_Umsy_2000s[j], seq(0,2.5,length.out=nrow(dat))[j]),#
        xpd=NA)#
}  #
}#
mtext(expression('U/U'[MSY]),2,outer=T)
mtext(expression('U/U'[MSY]),2,line=2outer=T)
mtext(expression('U/U'[MSY]),2,line=2,outer=T)
mtext(expression('U/U'[MSY]),2,line=1,outer=T)
par(mfrow=c(3,2))#
par(mar=c(2,2,1,5), oma=c(2,2,1,1))#
#
for(i in c(1,3,2)) {#
dat1 = all.dat[all.dat$system==systems[i],]#
#
dat <- dat1 %>% #
  arrange(desc(SAll))#
#
col.range <- colorRampPalette(c("red", "blue"))(nrow(dat))#
# col.range <- paste(col.range, "99", sep="")#
scaled.size <- sqrt(dat$SAll/max(dat$SAll))#
#
plot(x=dat$S_Smsy_1980s, y=dat$U_Umsy_1980s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*4, pch=21, xlim=c(0,4), ylim=c(0,2.5), col="black",#
     xlab="", ylab="", cex.axis=1, cex.lab=1, las=1,#
     cex.main=2)#
abline(h=1)#
abline(v=1)#
text(x=rep(4.2,nrow(dat)), y=seq(0,2.5,length.out=nrow(dat)),#
     labels = dat$lake, pos=4, xpd=NA, cex=1)#
#
for(j in 1:nrow(dat)) {#
  lines(x=c(dat$S_Smsy_1980s[j], 4.22),#
        y=c(dat$U_Umsy_1980s[j], seq(0,2.5,length.out=nrow(dat))[j]),#
        xpd=NA, col="grey")
}
par(mfrow=c(3,2))#
par(mar=c(2,2,1,5), oma=c(2,2,1,2))#
#
for(i in c(1,3,2)) {#
dat1 = all.dat[all.dat$system==systems[i],]#
#
dat <- dat1 %>% #
  arrange(desc(SAll))#
#
col.range <- colorRampPalette(c("red", "blue"))(nrow(dat))#
# col.range <- paste(col.range, "99", sep="")#
scaled.size <- sqrt(dat$SAll/max(dat$SAll))#
#
plot(x=dat$S_Smsy_1980s, y=dat$U_Umsy_1980s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*4, pch=21, xlim=c(0,4), ylim=c(0,2.5), col="black",#
     xlab="", ylab="", cex.axis=1, cex.lab=1, las=1,#
     cex.main=2)#
abline(h=1)#
abline(v=1)#
text(x=rep(4.2,nrow(dat)), y=seq(0,2.5,length.out=nrow(dat)),#
     labels = dat$lake, pos=4, xpd=NA, cex=1)#
#
for(j in 1:nrow(dat)) {#
  lines(x=c(dat$S_Smsy_1980s[j], 4.22),#
        y=c(dat$U_Umsy_1980s[j], seq(0,2.5,length.out=nrow(dat))[j]),#
        xpd=NA, col="grey")#
}#
plot(x=dat$S_Smsy_2000s, y=dat$U_Umsy_2000s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*5, pch=21, xlim=c(0,4), ylim=c(0,2.5), col="black",#
     xlab="S/Smsy", ylab="", main=systems[i], cex.axis=2, cex.lab=2, las=1,#
     cex.main=2)#
abline(h=1)#
abline(v=1)#
text(x=rep(4.2,nrow(dat)), y=seq(0,2.5,length.out=nrow(dat)),#
     labels = dat$lake, pos=4, xpd=NA, cex=2)#
#
for(j in 1:nrow(dat)) {#
  lines(x=c(dat$S_Smsy_2000s[j], 4.22),#
        y=c(dat$U_Umsy_2000s[j], seq(0,2.5,length.out=nrow(dat))[j]),#
        xpd=NA)#
}  #
}#
mtext(expression('U/U'[MSY]),2,line=1,outer=T)
points(x=dat$S_Smsy_1980s, y=dat$U_Umsy_1980s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*4, pch=21, col="black")
par(mfrow=c(3,2))#
par(mar=c(2,2,1,5), oma=c(2,2,1,2))#
#
for(i in c(1,3,2)) {#
dat1 = all.dat[all.dat$system==systems[i],]#
#
dat <- dat1 %>% #
  arrange(desc(SAll))#
#
col.range <- colorRampPalette(c("red", "blue"))(nrow(dat))#
# col.range <- paste(col.range, "99", sep="")#
scaled.size <- sqrt(dat$SAll/max(dat$SAll))#
#
plot(x=dat$S_Smsy_1980s, y=dat$U_Umsy_1980s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*4, pch=21, xlim=c(0,4), ylim=c(0,2.5), col="black",#
     xlab="", ylab="", cex.axis=1, cex.lab=1, las=1,#
     cex.main=2)#
abline(h=1)#
abline(v=1)#
#
points(x=dat$S_Smsy_1980s, y=dat$U_Umsy_1980s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*4, pch=21, col="black")#
plot(x=dat$S_Smsy_2000s, y=dat$U_Umsy_2000s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*5, pch=21, xlim=c(0,4), ylim=c(0,2.5), col="black",#
     xlab="S/Smsy", ylab="", main=systems[i], cex.axis=2, cex.lab=2, las=1,#
     cex.main=2)#
abline(h=1)#
abline(v=1)#
#
text(x=rep(4.2,nrow(dat)), y=seq(0,2.5,length.out=nrow(dat)),#
     labels = dat$lake, pos=4, xpd=NA, cex=1)#
#
for(j in 1:nrow(dat)) {#
  lines(x=c(dat$S_Smsy_1980s[j], 4.22),#
        y=c(dat$U_Umsy_1980s[j], seq(0,2.5,length.out=nrow(dat))[j]),#
        xpd=NA, col="grey")  #
} #
#
points(x=dat$S_Smsy_1980s, y=dat$U_Umsy_1980s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*4, pch=21, col="black")#
}#
mtext(expression('U/U'[MSY]),2,line=1,outer=T)
par(mfrow=c(3,2))#
par(mar=c(1,1,1,1), oma=c(3,3,1,8))#
#
for(i in c(1,3,2)) {#
dat1 = all.dat[all.dat$system==systems[i],]#
#
dat <- dat1 %>% #
  arrange(desc(SAll))#
#
col.range <- colorRampPalette(c("red", "blue"))(nrow(dat))#
# col.range <- paste(col.range, "99", sep="")#
scaled.size <- sqrt(dat$SAll/max(dat$SAll))#
#
plot(x=dat$S_Smsy_1980s, y=dat$U_Umsy_1980s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*4, pch=21, xlim=c(0,4), ylim=c(0,2.5), col="black",#
     xlab="", ylab="", cex.axis=1, cex.lab=1, las=1)#
abline(h=1)#
abline(v=1)#
#
points(x=dat$S_Smsy_1980s, y=dat$U_Umsy_1980s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*4, pch=21, col="black")#
plot(x=dat$S_Smsy_2000s, y=dat$U_Umsy_2000s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*4, pch=21, xlim=c(0,4), ylim=c(0,2.5), col="black",#
     xlab="", ylab="", cex.axis=1, cex.lab=1, las=1)#
abline(h=1)#
abline(v=1)#
#
text(x=rep(4.2,nrow(dat)), y=seq(0,2.5,length.out=nrow(dat)),#
     labels = dat$lake, pos=4, xpd=NA, cex=1)#
#
for(j in 1:nrow(dat)) {#
  lines(x=c(dat$S_Smsy_1980s[j], 4.22),#
        y=c(dat$U_Umsy_1980s[j], seq(0,2.5,length.out=nrow(dat))[j]),#
        xpd=NA, col="grey")  #
} #
#
points(x=dat$S_Smsy_2000s, y=dat$U_Umsy_2000s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*4, pch=21, col="black")#
}#
mtext(expression('U/U'[MSY]),2,line=1,outer=T)#
mtext(expression('S/S'[MSY]),1,line=1,outer=T)
png("SuppMat_01.20.2020.png", width=8, height=8, units = "in", res = 500)#
par(mfrow=c(3,2))#
par(mar=c(1,1,1,1), oma=c(3,3,1,8))#
#
for(i in c(1,3,2)) {#
dat1 = all.dat[all.dat$system==systems[i],]#
#
dat <- dat1 %>% #
  arrange(desc(SAll))#
#
col.range <- colorRampPalette(c("red", "blue"))(nrow(dat))#
# col.range <- paste(col.range, "99", sep="")#
scaled.size <- sqrt(dat$SAll/max(dat$SAll))#
#
plot(x=dat$S_Smsy_1980s, y=dat$U_Umsy_1980s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*4, pch=21, xlim=c(0,4), ylim=c(0,2.5), col="black",#
     xlab="", ylab="", cex.axis=1, cex.lab=1, las=1)#
abline(h=1)#
abline(v=1)#
#
points(x=dat$S_Smsy_1980s, y=dat$U_Umsy_1980s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*4, pch=21, col="black")#
plot(x=dat$S_Smsy_2000s, y=dat$U_Umsy_2000s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*4, pch=21, xlim=c(0,4), ylim=c(0,2.5), col="black",#
     xlab="", ylab="", cex.axis=1, cex.lab=1, las=1)#
abline(h=1)#
abline(v=1)#
#
text(x=rep(4.2,nrow(dat)), y=seq(0,2.5,length.out=nrow(dat)),#
     labels = dat$lake, pos=4, xpd=NA, cex=1)#
#
for(j in 1:nrow(dat)) {#
  lines(x=c(dat$S_Smsy_2000s[j], 4.22),#
        y=c(dat$U_Umsy_2000s[j], seq(0,2.5,length.out=nrow(dat))[j]),#
        xpd=NA, col="grey")  #
} #
#
points(x=dat$S_Smsy_2000s, y=dat$U_Umsy_2000s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*4, pch=21, col="black")#
}#
mtext(expression('U/U'[MSY]),2,line=1.5,outer=T)#
mtext(expression('S/S'[MSY]),1,line=1.5,outer=T)#
dev.off()
png("SuppMat_01.20.2020.png", width=6, height=6, units = "in", res = 500)#
par(mfrow=c(3,2))#
par(mar=c(1,1,1,1), oma=c(3,3,1,8))#
#
for(i in c(1,3,2)) {#
dat1 = all.dat[all.dat$system==systems[i],]#
#
dat <- dat1 %>% #
  arrange(desc(SAll))#
#
col.range <- colorRampPalette(c("red", "blue"))(nrow(dat))#
# col.range <- paste(col.range, "99", sep="")#
scaled.size <- sqrt(dat$SAll/max(dat$SAll))#
#
plot(x=dat$S_Smsy_1980s, y=dat$U_Umsy_1980s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*4, pch=21, xlim=c(0,4), ylim=c(0,2.5), col="black",#
     xlab="", ylab="", cex.axis=1, cex.lab=1, las=1)#
abline(h=1)#
abline(v=1)#
#
points(x=dat$S_Smsy_1980s, y=dat$U_Umsy_1980s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*4, pch=21, col="black")#
plot(x=dat$S_Smsy_2000s, y=dat$U_Umsy_2000s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*4, pch=21, xlim=c(0,4), ylim=c(0,2.5), col="black",#
     xlab="", ylab="", cex.axis=1, cex.lab=1, las=1)#
abline(h=1)#
abline(v=1)#
#
text(x=rep(4.2,nrow(dat)), y=seq(0,2.5,length.out=nrow(dat)),#
     labels = dat$lake, pos=4, xpd=NA, cex=1)#
#
for(j in 1:nrow(dat)) {#
  lines(x=c(dat$S_Smsy_2000s[j], 4.22),#
        y=c(dat$U_Umsy_2000s[j], seq(0,2.5,length.out=nrow(dat))[j]),#
        xpd=NA, col="grey")  #
} #
#
points(x=dat$S_Smsy_2000s, y=dat$U_Umsy_2000s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*4, pch=21, col="black")#
}#
mtext(expression('U/U'[MSY]),2,line=1.5,outer=T)#
mtext(expression('S/S'[MSY]),1,line=1.5,outer=T)#
dev.off()
png("SuppMat_01.20.2020.png", width=6, height=6, units = "in", res = 500)#
par(mfrow=c(3,2))#
par(mar=c(1,1,1,1), oma=c(3,3,1,8))#
#
for(i in c(1,3,2)) {#
dat1 = all.dat[all.dat$system==systems[i],]#
#
dat <- dat1 %>% #
  arrange(desc(SAll))#
#
col.range <- colorRampPalette(c("red", "blue"))(nrow(dat))#
# col.range <- paste(col.range, "99", sep="")#
scaled.size <- sqrt(dat$SAll/max(dat$SAll))#
#
plot(x=dat$S_Smsy_1980s, y=dat$U_Umsy_1980s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*4, pch=21, xlim=c(0,4), ylim=c(0,2.5), col="black",#
     xlab="", ylab="", cex.axis=1, cex.lab=1, las=1)#
abline(h=1)#
abline(v=1)#
#
points(x=dat$S_Smsy_1980s, y=dat$U_Umsy_1980s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*4, pch=21, col="black")#
plot(x=dat$S_Smsy_2000s, y=dat$U_Umsy_2000s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*4, pch=21, xlim=c(0,4), ylim=c(0,2.5), col="black",#
     xlab="", ylab="", cex.axis=1, cex.lab=1, las=1)#
abline(h=1)#
abline(v=1)#
#
text(x=rep(4.2,nrow(dat)), y=seq(0,2.5,length.out=nrow(dat)),#
     labels = dat$lake, pos=4, xpd=NA, cex=1, col=col.range[dat$alpha.order])#
#
for(j in 1:nrow(dat)) {#
  lines(x=c(dat$S_Smsy_2000s[j], 4.22),#
        y=c(dat$U_Umsy_2000s[j], seq(0,2.5,length.out=nrow(dat))[j]),#
        xpd=NA, col="grey")  #
} #
#
points(x=dat$S_Smsy_2000s, y=dat$U_Umsy_2000s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*4, pch=21, col="black")#
}#
mtext(expression('U/U'[MSY]),2,line=1.5,outer=T)#
mtext(expression('S/S'[MSY]),1,line=1.5,outer=T)#
dev.off()
png("SuppMat_01.20.2020.png", width=6, height=6, units = "in", res = 500)#
par(mfrow=c(3,2))#
par(mar=c(1,1,1,1), oma=c(3,3,1,8))#
#
for(i in c(1,3,2)) {#
dat1 = all.dat[all.dat$system==systems[i],]#
#
dat <- dat1 %>% #
  arrange(desc(SAll))#
#
col.range <- colorRampPalette(c("red", "blue"))(nrow(dat))#
# col.range <- paste(col.range, "99", sep="")#
scaled.size <- sqrt(dat$SAll/max(dat$SAll))#
#
plot(x=dat$S_Smsy_1980s, y=dat$U_Umsy_1980s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*4, pch=21, xlim=c(0,4), ylim=c(0,2.5), col="black",#
     xlab="", ylab="", cex.axis=1, cex.lab=1, las=1)#
abline(h=1)#
abline(v=1)#
#
points(x=dat$S_Smsy_1980s, y=dat$U_Umsy_1980s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*4, pch=21, col="black")#
plot(x=dat$S_Smsy_2000s, y=dat$U_Umsy_2000s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*4, pch=21, xlim=c(0,4), ylim=c(0,2.5), col="black",#
     xlab="", ylab="", cex.axis=1, cex.lab=1, las=1)#
abline(h=1)#
abline(v=1)#
#
text(x=rep(4.2,nrow(dat)), y=seq(0,2.5,length.out=nrow(dat)),#
     labels = dat$lake, pos=4, xpd=NA, cex=1, col=col.range[dat$alpha.order])#
#
for(j in 1:nrow(dat)) {#
  lines(x=c(dat$S_Smsy_2000s[j], 4.22),#
        y=c(dat$U_Umsy_2000s[j], seq(0,2.5,length.out=nrow(dat))[j]),#
        xpd=NA, col=col.range[dat$alpha.order])  #
} #
#
points(x=dat$S_Smsy_2000s, y=dat$U_Umsy_2000s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*4, pch=21, col="black")#
}#
mtext(expression('U/U'[MSY]),2,line=1.5,outer=T)#
mtext(expression('S/S'[MSY]),1,line=1.5,outer=T)#
dev.off()
png("SuppMat_01.20.2020.png", width=6, height=6, units = "in", res = 500)#
par(mfrow=c(3,2))#
par(mar=c(1,1,1,1), oma=c(3,3,1,8))#
#
for(i in c(1,3,2)) {#
dat1 = all.dat[all.dat$system==systems[i],]#
#
dat <- dat1 %>% #
  arrange(desc(SAll))#
#
col.range <- colorRampPalette(c("red", "blue"))(nrow(dat))#
# col.range <- paste(col.range, "99", sep="")#
scaled.size <- sqrt(dat$SAll/max(dat$SAll))#
#
plot(x=dat$S_Smsy_1980s, y=dat$U_Umsy_1980s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*4, pch=21, xlim=c(0,4), ylim=c(0,2.5), col="black",#
     xlab="", ylab="", cex.axis=1, cex.lab=1, las=1)#
abline(h=1)#
abline(v=1)#
#
points(x=dat$S_Smsy_1980s, y=dat$U_Umsy_1980s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*4, pch=21, col="black")#
plot(x=dat$S_Smsy_2000s, y=dat$U_Umsy_2000s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*4, pch=21, xlim=c(0,4), ylim=c(0,2.5), col="black",#
     xlab="", ylab="", cex.axis=1, cex.lab=1, las=1)#
abline(h=1)#
abline(v=1)#
#
text(x=rep(4.2,nrow(dat)), y=seq(0,2.5,length.out=nrow(dat)),#
     labels = dat$lake, pos=4, xpd=NA, cex=1, col=col.range[dat$alpha.order])#
#
for(j in 1:nrow(dat)) {#
  lines(x=c(dat$S_Smsy_2000s[j], 4.22),#
        y=c(dat$U_Umsy_2000s[j], seq(0,2.5,length.out=nrow(dat))[j]),#
        xpd=NA, col="light grey")  #
} #
#
points(x=dat$S_Smsy_2000s, y=dat$U_Umsy_2000s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*4, pch=21, col="black")#
}#
mtext(expression('U/U'[MSY]),2,line=1.5,outer=T)#
mtext(expression('S/S'[MSY]),1,line=1.5,outer=T)#
dev.off()
png("SuppMat_01.20.2020.png", width=6, height=6, units = "in", res = 500)#
par(mfrow=c(3,2))#
par(mar=c(1,1,1,1), oma=c(3,3,1,8))#
#
for(i in c(1,3,2)) {#
dat1 = all.dat[all.dat$system==systems[i],]#
#
dat <- dat1 %>% #
  arrange(desc(SAll))#
#
col.range <- colorRampPalette(c("red", "blue"))(nrow(dat))#
# col.range <- paste(col.range, "99", sep="")#
scaled.size <- sqrt(dat$SAll/max(dat$SAll))#
#
plot(x=dat$S_Smsy_1980s, y=dat$U_Umsy_1980s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*4, pch=21, xlim=c(0,4), ylim=c(0,2.5), col="black",#
     xlab="", ylab="", cex.axis=1, cex.lab=1, las=1)#
abline(h=1)#
abline(v=1)#
box(bty="grey")#
points(x=dat$S_Smsy_1980s, y=dat$U_Umsy_1980s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*4, pch=21, col="black")#
plot(x=dat$S_Smsy_2000s, y=dat$U_Umsy_2000s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*4, pch=21, xlim=c(0,4), ylim=c(0,2.5), col="black",#
     xlab="", ylab="", cex.axis=1, cex.lab=1, las=1)#
abline(h=1)#
abline(v=1)#
#
text(x=rep(4.2,nrow(dat)), y=seq(0,2.5,length.out=nrow(dat)),#
     labels = dat$lake, pos=4, xpd=NA, cex=1, col=col.range[dat$alpha.order])#
#
for(j in 1:nrow(dat)) {#
  lines(x=c(dat$S_Smsy_2000s[j], 4.22),#
        y=c(dat$U_Umsy_2000s[j], seq(0,2.5,length.out=nrow(dat))[j]),#
        xpd=NA, col="light grey")  #
} #
#
points(x=dat$S_Smsy_2000s, y=dat$U_Umsy_2000s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*4, pch=21, col="black")#
}#
mtext(expression('U/U'[MSY]),2,line=1.5,outer=T)#
mtext(expression('S/S'[MSY]),1,line=1.5,outer=T)#
dev.off()
png("SuppMat_01.20.2020.png", width=6, height=6, units = "in", res = 500)#
par(mfrow=c(3,2))#
par(mar=c(1,1,1,1), oma=c(3,3,1,8))#
#
for(i in c(1,3,2)) {#
dat1 = all.dat[all.dat$system==systems[i],]#
#
dat <- dat1 %>% #
  arrange(desc(SAll))#
#
col.range <- colorRampPalette(c("red", "blue"))(nrow(dat))#
# col.range <- paste(col.range, "99", sep="")#
scaled.size <- sqrt(dat$SAll/max(dat$SAll))#
#
plot(x=dat$S_Smsy_1980s, y=dat$U_Umsy_1980s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*4, pch=21, xlim=c(0,4), ylim=c(0,2.5), col="black",#
     xlab="", ylab="", cex.axis=1, cex.lab=1, las=1)#
abline(h=1)#
abline(v=1)#
box(col="grey")#
points(x=dat$S_Smsy_1980s, y=dat$U_Umsy_1980s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*4, pch=21, col="black")#
plot(x=dat$S_Smsy_2000s, y=dat$U_Umsy_2000s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*4, pch=21, xlim=c(0,4), ylim=c(0,2.5), col="black",#
     xlab="", ylab="", cex.axis=1, cex.lab=1, las=1)#
abline(h=1)#
abline(v=1)#
#
text(x=rep(4.2,nrow(dat)), y=seq(0,2.5,length.out=nrow(dat)),#
     labels = dat$lake, pos=4, xpd=NA, cex=1, col=col.range[dat$alpha.order])#
#
for(j in 1:nrow(dat)) {#
  lines(x=c(dat$S_Smsy_2000s[j], 4.22),#
        y=c(dat$U_Umsy_2000s[j], seq(0,2.5,length.out=nrow(dat))[j]),#
        xpd=NA, col="light grey")  #
} #
#
points(x=dat$S_Smsy_2000s, y=dat$U_Umsy_2000s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*4, pch=21, col="black")#
}#
mtext(expression('U/U'[MSY]),2,line=1.5,outer=T)#
mtext(expression('S/S'[MSY]),1,line=1.5,outer=T)#
dev.off()
png("SuppMat_01.20.2020.png", width=6, height=6, units = "in", res = 500)#
par(mfrow=c(3,2))#
par(mar=c(1,1,1,1), oma=c(3,3,1,8))#
#
for(i in c(1,3,2)) {#
dat1 = all.dat[all.dat$system==systems[i],]#
#
dat <- dat1 %>% #
  arrange(desc(SAll))#
#
col.range <- colorRampPalette(c("red", "blue"))(nrow(dat))#
# col.range <- paste(col.range, "99", sep="")#
scaled.size <- sqrt(dat$SAll/max(dat$SAll))#
#
plot(x=dat$S_Smsy_1980s, y=dat$U_Umsy_1980s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*5, pch=21, xlim=c(0,4), ylim=c(0,2.5), col="black",#
     xlab="", ylab="", cex.axis=1, cex.lab=1, las=1)#
abline(h=1)#
abline(v=1)#
box(col="grey")#
#
points(x=dat$S_Smsy_1980s, y=dat$U_Umsy_1980s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*4, pch=21, col="black")#
plot(x=dat$S_Smsy_2000s, y=dat$U_Umsy_2000s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*4, pch=21, xlim=c(0,4), ylim=c(0,2.5), col="black",#
     xlab="", ylab="", cex.axis=1, cex.lab=1, las=1)#
abline(h=1)#
abline(v=1)#
box(col="grey")#
#
text(x=rep(4.2,nrow(dat)), y=seq(0,2.5,length.out=nrow(dat)),#
     labels = dat$lake, pos=4, xpd=NA, cex=1, col=col.range[dat$alpha.order], font=4)#
#
for(j in 1:nrow(dat)) {#
  lines(x=c(dat$S_Smsy_2000s[j], 4.22),#
        y=c(dat$U_Umsy_2000s[j], seq(0,2.5,length.out=nrow(dat))[j]),#
        xpd=NA, col="light grey")  #
} #
#
points(x=dat$S_Smsy_2000s, y=dat$U_Umsy_2000s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*5, pch=21, col="black")#
}#
mtext(expression('U/U'[MSY]),2,line=1.5,outer=T)#
mtext(expression('S/S'[MSY]),1,line=1.5,outer=T)#
dev.off()
png("SuppMat_01.20.2020.png", width=6, height=6, units = "in", res = 500)#
par(mfrow=c(3,2))#
par(mar=c(1,1,1,1), oma=c(3,3,1,8))#
#
for(i in c(1,3,2)) {#
dat1 = all.dat[all.dat$system==systems[i],]#
#
dat <- dat1 %>% #
  arrange(desc(SAll))#
#
col.range <- colorRampPalette(c("red", "blue"))(nrow(dat))#
# col.range <- paste(col.range, "99", sep="")#
scaled.size <- sqrt(dat$SAll/max(dat$SAll))#
#
plot(x=dat$S_Smsy_1980s, y=dat$U_Umsy_1980s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*5, pch=21, xlim=c(0,4), ylim=c(0,2.5), col="black",#
     xlab="", ylab="", cex.axis=1, cex.lab=1, las=1)#
abline(h=1)#
abline(v=1)#
box(col="grey")#
#
points(x=dat$S_Smsy_1980s, y=dat$U_Umsy_1980s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*4, pch=21, col="black")#
plot(x=dat$S_Smsy_2000s, y=dat$U_Umsy_2000s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*4, pch=21, xlim=c(0,4), ylim=c(0,2.5), col="black",#
     xlab="", ylab="", cex.axis=1, cex.lab=1, las=1)#
abline(h=1)#
abline(v=1)#
box(col="grey")#
#
text(x=rep(4.2,nrow(dat)), y=seq(0,2.5,length.out=nrow(dat)),#
     labels = dat$lake, pos=4, xpd=NA, cex=1, col=col.range[dat$alpha.order], font=2)#
#
for(j in 1:nrow(dat)) {#
  lines(x=c(dat$S_Smsy_2000s[j], 4.22),#
        y=c(dat$U_Umsy_2000s[j], seq(0,2.5,length.out=nrow(dat))[j]),#
        xpd=NA, col="light grey")  #
} #
#
points(x=dat$S_Smsy_2000s, y=dat$U_Umsy_2000s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*5, pch=21, col="black")#
}#
mtext(expression('U/U'[MSY]),2,line=1.5,outer=T)#
mtext(expression('S/S'[MSY]),1,line=1.5,outer=T)#
dev.off()
png("SuppMat_01.20.2020.png", width=6, height=6, units = "in", res = 500)#
par(mfrow=c(3,2))#
par(mar=c(1,1,1,1), oma=c(3,3,1,8))#
#
for(i in c(1,3,2)) {#
dat1 = all.dat[all.dat$system==systems[i],]#
#
dat <- dat1 %>% #
  arrange(desc(SAll))#
#
col.range <- colorRampPalette(c("red", "blue"))(nrow(dat))#
# col.range <- paste(col.range, "99", sep="")#
scaled.size <- sqrt(dat$SAll/max(dat$SAll))#
#
plot(x=dat$S_Smsy_1980s, y=dat$U_Umsy_1980s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*5, pch=21, xlim=c(0,4), ylim=c(0,2.5), col="black",#
     xlab="", ylab="", cex.axis=1, cex.lab=1, las=1,yaxt="n",xaxt="n")#
abline(h=1)#
abline(v=1)#
box(col="grey")#
#
points(x=dat$S_Smsy_1980s, y=dat$U_Umsy_1980s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*4, pch=21, col="black")#
plot(x=dat$S_Smsy_2000s, y=dat$U_Umsy_2000s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*5, pch=21, xlim=c(0,4), ylim=c(0,2.5), col="black",#
     xlab="", ylab="", cex.axis=1, cex.lab=1, las=1)#
abline(h=1)#
abline(v=1)#
box(col="grey")#
#
text(x=rep(4.2,nrow(dat)), y=seq(0,2.5,length.out=nrow(dat)),#
     labels = dat$lake, pos=4, xpd=NA, cex=1, col=col.range[dat$alpha.order], font=2)#
#
for(j in 1:nrow(dat)) {#
  lines(x=c(dat$S_Smsy_2000s[j], 4.22),#
        y=c(dat$U_Umsy_2000s[j], seq(0,2.5,length.out=nrow(dat))[j]),#
        xpd=NA, col="light grey")  #
} #
#
points(x=dat$S_Smsy_2000s, y=dat$U_Umsy_2000s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*5, pch=21, col="black")#
}#
mtext(expression('U/U'[MSY]),2,line=1.5,outer=T)#
mtext(expression('S/S'[MSY]),1,line=1.5,outer=T)#
dev.off()
png("SuppMat_01.20.2020.png", width=6, height=6, units = "in", res = 500)#
par(mfrow=c(3,2))#
par(mar=c(1,1,1,1), oma=c(3,3,1,8))#
#
for(i in c(1,3,2)) {#
dat1 = all.dat[all.dat$system==systems[i],]#
#
dat <- dat1 %>% #
  arrange(desc(SAll))#
#
col.range <- colorRampPalette(c("red", "blue"))(nrow(dat))#
# col.range <- paste(col.range, "99", sep="")#
scaled.size <- sqrt(dat$SAll/max(dat$SAll))#
#
plot(x=dat$S_Smsy_1980s, y=dat$U_Umsy_1980s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*5, pch=21, xlim=c(0,4), ylim=c(0,2.5), col="black",#
     xlab="", ylab="", cex.axis=1, cex.lab=1, las=1,yaxt="n",xaxt="n")#
abline(h=1)#
abline(v=1)#
axis(1,labels=F)#
box(col="grey")#
#
points(x=dat$S_Smsy_1980s, y=dat$U_Umsy_1980s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*4, pch=21, col="black")#
plot(x=dat$S_Smsy_2000s, y=dat$U_Umsy_2000s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*5, pch=21, xlim=c(0,4), ylim=c(0,2.5), col="black",#
     xlab="", ylab="", cex.axis=1, cex.lab=1, las=1,yaxt="n",xaxt="n")#
abline(h=1)#
abline(v=1)#
box(col="grey")#
#
text(x=rep(4.2,nrow(dat)), y=seq(0,2.5,length.out=nrow(dat)),#
     labels = dat$lake, pos=4, xpd=NA, cex=1, col=col.range[dat$alpha.order], font=2)#
#
for(j in 1:nrow(dat)) {#
  lines(x=c(dat$S_Smsy_2000s[j], 4.22),#
        y=c(dat$U_Umsy_2000s[j], seq(0,2.5,length.out=nrow(dat))[j]),#
        xpd=NA, col="light grey")  #
} #
#
points(x=dat$S_Smsy_2000s, y=dat$U_Umsy_2000s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*5, pch=21, col="black")#
}#
mtext(expression('U/U'[MSY]),2,line=1.5,outer=T)#
mtext(expression('S/S'[MSY]),1,line=1.5,outer=T)#
dev.off()
axis(2)
png("SuppMat_01.20.2020.png", width=6, height=6, units = "in", res = 500)#
par(mfrow=c(3,2))#
par(mar=c(1,1,1,1), oma=c(3,3,1,8))#
#
for(i in c(1,3,2)) {#
dat1 = all.dat[all.dat$system==systems[i],]#
#
dat <- dat1 %>% #
  arrange(desc(SAll))#
#
col.range <- colorRampPalette(c("red", "blue"))(nrow(dat))#
# col.range <- paste(col.range, "99", sep="")#
scaled.size <- sqrt(dat$SAll/max(dat$SAll))#
#
plot(x=dat$S_Smsy_1980s, y=dat$U_Umsy_1980s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*5, pch=21, xlim=c(0,4), ylim=c(0,2.5), col="black",#
     xlab="", ylab="", cex.axis=1, cex.lab=1, las=1,yaxt="n",xaxt="n")#
abline(h=1)#
abline(v=1)#
axis(1,labels=F)#
axis(2)#
#
box(col="grey")#
#
points(x=dat$S_Smsy_1980s, y=dat$U_Umsy_1980s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*4, pch=21, col="black")#
plot(x=dat$S_Smsy_2000s, y=dat$U_Umsy_2000s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*5, pch=21, xlim=c(0,4), ylim=c(0,2.5), col="black",#
     xlab="", ylab="", cex.axis=1, cex.lab=1, las=1,yaxt="n",xaxt="n")#
abline(h=1)#
abline(v=1)#
box(col="grey")#
#
text(x=rep(4.2,nrow(dat)), y=seq(0,2.5,length.out=nrow(dat)),#
     labels = dat$lake, pos=4, xpd=NA, cex=1, col=col.range[dat$alpha.order], font=2)#
#
for(j in 1:nrow(dat)) {#
  lines(x=c(dat$S_Smsy_2000s[j], 4.22),#
        y=c(dat$U_Umsy_2000s[j], seq(0,2.5,length.out=nrow(dat))[j]),#
        xpd=NA, col="light grey")  #
} #
#
points(x=dat$S_Smsy_2000s, y=dat$U_Umsy_2000s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*5, pch=21, col="black")#
}#
mtext(expression('U/U'[MSY]),2,line=1.5,outer=T)#
mtext(expression('S/S'[MSY]),1,line=1.5,outer=T)#
dev.off()
png("SuppMat_01.20.2020.png", width=6, height=6, units = "in", res = 500)#
par(mfrow=c(3,2))#
par(mar=c(1,1,1,1), oma=c(3,3,1,8))#
#
for(i in c(1,3,2)) {#
dat1 = all.dat[all.dat$system==systems[i],]#
#
dat <- dat1 %>% #
  arrange(desc(SAll))#
#
col.range <- colorRampPalette(c("red", "blue"))(nrow(dat))#
# col.range <- paste(col.range, "99", sep="")#
scaled.size <- sqrt(dat$SAll/max(dat$SAll))#
#
plot(x=dat$S_Smsy_1980s, y=dat$U_Umsy_1980s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*5, pch=21, xlim=c(0,4), ylim=c(0,2.5), col="black",#
     xlab="", ylab="", cex.axis=1, cex.lab=1, las=1,yaxt="n",xaxt="n")#
abline(h=1)#
abline(v=1)#
axis(1,labels=F)#
axis(2,las=2)#
#
box(col="grey")#
#
points(x=dat$S_Smsy_1980s, y=dat$U_Umsy_1980s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*4, pch=21, col="black")#
plot(x=dat$S_Smsy_2000s, y=dat$U_Umsy_2000s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*5, pch=21, xlim=c(0,4), ylim=c(0,2.5), col="black",#
     xlab="", ylab="", cex.axis=1, cex.lab=1, las=1,yaxt="n",xaxt="n")#
abline(h=1)#
abline(v=1)#
box(col="grey")#
#
text(x=rep(4.2,nrow(dat)), y=seq(0,2.5,length.out=nrow(dat)),#
     labels = dat$lake, pos=4, xpd=NA, cex=1, col=col.range[dat$alpha.order], font=2)#
#
for(j in 1:nrow(dat)) {#
  lines(x=c(dat$S_Smsy_2000s[j], 4.22),#
        y=c(dat$U_Umsy_2000s[j], seq(0,2.5,length.out=nrow(dat))[j]),#
        xpd=NA, col="light grey")  #
} #
#
points(x=dat$S_Smsy_2000s, y=dat$U_Umsy_2000s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*5, pch=21, col="black")#
}#
mtext(expression('U/U'[MSY]),2,line=1.5,outer=T)#
mtext(expression('S/S'[MSY]),1,line=1.5,outer=T)#
dev.off()
png("SuppMat_01.20.2020.png", width=6, height=6, units = "in", res = 500)#
par(mfrow=c(3,2))#
par(mar=c(1,1,1,1), oma=c(3,3,1,8))#
#
for(i in c(1,3,2)) {#
dat1 = all.dat[all.dat$system==systems[i],]#
#
dat <- dat1 %>% #
  arrange(desc(SAll))#
#
col.range <- colorRampPalette(c("red", "blue"))(nrow(dat))#
# col.range <- paste(col.range, "99", sep="")#
scaled.size <- sqrt(dat$SAll/max(dat$SAll))#
#
plot(x=dat$S_Smsy_1980s, y=dat$U_Umsy_1980s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*5, pch=21, xlim=c(0,4), ylim=c(0,2.5), col="black",#
     xlab="", ylab="", cex.axis=1, cex.lab=1, las=1,yaxt="n",xaxt="n")#
abline(h=1)#
abline(v=1)#
if(i=3){axis(1)}else{axis(1,labels=F)}#
#
axis(2,las=2)#
box(col="grey")#
#
points(x=dat$S_Smsy_1980s, y=dat$U_Umsy_1980s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*4, pch=21, col="black")#
plot(x=dat$S_Smsy_2000s, y=dat$U_Umsy_2000s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*5, pch=21, xlim=c(0,4), ylim=c(0,2.5), col="black",#
     xlab="", ylab="", cex.axis=1, cex.lab=1, las=1,yaxt="n",xaxt="n")#
abline(h=1)#
abline(v=1)#
axis(1,labels=F)#
axis(2,labels=F)#
box(col="grey")#
#
text(x=rep(4.2,nrow(dat)), y=seq(0,2.5,length.out=nrow(dat)),#
     labels = dat$lake, pos=4, xpd=NA, cex=1, col=col.range[dat$alpha.order], font=2)#
#
for(j in 1:nrow(dat)) {#
  lines(x=c(dat$S_Smsy_2000s[j], 4.22),#
        y=c(dat$U_Umsy_2000s[j], seq(0,2.5,length.out=nrow(dat))[j]),#
        xpd=NA, col="light grey")  #
} #
#
points(x=dat$S_Smsy_2000s, y=dat$U_Umsy_2000s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*5, pch=21, col="black")#
}#
mtext(expression('U/U'[MSY]),2,line=1.5,outer=T)#
mtext(expression('S/S'[MSY]),1,line=1.5,outer=T)#
dev.off()
png("SuppMat_01.20.2020.png", width=6, height=6, units = "in", res = 500)#
par(mfrow=c(3,2))#
par(mar=c(1,1,1,1), oma=c(3,3,1,8))#
#
for(i in c(1,3,2)) {#
dat1 = all.dat[all.dat$system==systems[i],]#
#
dat <- dat1 %>% #
  arrange(desc(SAll))#
#
col.range <- colorRampPalette(c("red", "blue"))(nrow(dat))#
# col.range <- paste(col.range, "99", sep="")#
scaled.size <- sqrt(dat$SAll/max(dat$SAll))#
#
plot(x=dat$S_Smsy_1980s, y=dat$U_Umsy_1980s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*5, pch=21, xlim=c(0,4), ylim=c(0,2.5), col="black",#
     xlab="", ylab="", cex.axis=1, cex.lab=1, las=1,yaxt="n",xaxt="n")#
abline(h=1)#
abline(v=1)#
ifelse(i=3,axis(1),axis(1,labels=F))#
#
axis(2,las=2)#
box(col="grey")#
#
points(x=dat$S_Smsy_1980s, y=dat$U_Umsy_1980s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*4, pch=21, col="black")#
plot(x=dat$S_Smsy_2000s, y=dat$U_Umsy_2000s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*5, pch=21, xlim=c(0,4), ylim=c(0,2.5), col="black",#
     xlab="", ylab="", cex.axis=1, cex.lab=1, las=1,yaxt="n",xaxt="n")#
abline(h=1)#
abline(v=1)#
axis(1,labels=F)#
axis(2,labels=F)#
box(col="grey")#
#
text(x=rep(4.2,nrow(dat)), y=seq(0,2.5,length.out=nrow(dat)),#
     labels = dat$lake, pos=4, xpd=NA, cex=1, col=col.range[dat$alpha.order], font=2)#
#
for(j in 1:nrow(dat)) {#
  lines(x=c(dat$S_Smsy_2000s[j], 4.22),#
        y=c(dat$U_Umsy_2000s[j], seq(0,2.5,length.out=nrow(dat))[j]),#
        xpd=NA, col="light grey")  #
} #
#
points(x=dat$S_Smsy_2000s, y=dat$U_Umsy_2000s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*5, pch=21, col="black")#
}#
mtext(expression('U/U'[MSY]),2,line=1.5,outer=T)#
mtext(expression('S/S'[MSY]),1,line=1.5,outer=T)#
dev.off()
i
ifelse(i==3,axis(1),axis(1,labels=F))
png("SuppMat_01.20.2020.png", width=6, height=6, units = "in", res = 500)#
par(mfrow=c(3,2))#
par(mar=c(1,1,1,1), oma=c(3,3,1,8))#
#
for(i in c(1,3,2)) {#
dat1 = all.dat[all.dat$system==systems[i],]#
#
dat <- dat1 %>% #
  arrange(desc(SAll))#
#
col.range <- colorRampPalette(c("red", "blue"))(nrow(dat))#
# col.range <- paste(col.range, "99", sep="")#
scaled.size <- sqrt(dat$SAll/max(dat$SAll))#
#
plot(x=dat$S_Smsy_1980s, y=dat$U_Umsy_1980s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*5, pch=21, xlim=c(0,4), ylim=c(0,2.5), col="black",#
     xlab="", ylab="", cex.axis=1, cex.lab=1, las=1,yaxt="n",xaxt="n")#
abline(h=1)#
abline(v=1)#
ifelse(i==3,axis(1),axis(1,labels=F))#
#
axis(2,las=2)#
box(col="grey")#
#
points(x=dat$S_Smsy_1980s, y=dat$U_Umsy_1980s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*4, pch=21, col="black")#
plot(x=dat$S_Smsy_2000s, y=dat$U_Umsy_2000s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*5, pch=21, xlim=c(0,4), ylim=c(0,2.5), col="black",#
     xlab="", ylab="", cex.axis=1, cex.lab=1, las=1,yaxt="n",xaxt="n")#
abline(h=1)#
abline(v=1)#
axis(1,labels=F)#
axis(2,labels=F)#
box(col="grey")#
#
text(x=rep(4.2,nrow(dat)), y=seq(0,2.5,length.out=nrow(dat)),#
     labels = dat$lake, pos=4, xpd=NA, cex=1, col=col.range[dat$alpha.order], font=2)#
#
for(j in 1:nrow(dat)) {#
  lines(x=c(dat$S_Smsy_2000s[j], 4.22),#
        y=c(dat$U_Umsy_2000s[j], seq(0,2.5,length.out=nrow(dat))[j]),#
        xpd=NA, col="light grey")  #
} #
#
points(x=dat$S_Smsy_2000s, y=dat$U_Umsy_2000s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*5, pch=21, col="black")#
}#
mtext(expression('U/U'[MSY]),2,line=1.5,outer=T)#
mtext(expression('S/S'[MSY]),1,line=1.5,outer=T)#
dev.off()
png("SuppMat_01.20.2020.png", width=6, height=6, units = "in", res = 500)#
par(mfrow=c(3,2))#
par(mar=c(1,1,1,1), oma=c(3,3,1,8))#
#
for(i in c(1,3,2)) {#
dat1 = all.dat[all.dat$system==systems[i],]#
#
dat <- dat1 %>% #
  arrange(desc(SAll))#
#
col.range <- colorRampPalette(c("red", "blue"))(nrow(dat))#
# col.range <- paste(col.range, "99", sep="")#
scaled.size <- sqrt(dat$SAll/max(dat$SAll))#
#
plot(x=dat$S_Smsy_1980s, y=dat$U_Umsy_1980s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*5, pch=21, xlim=c(0,4), ylim=c(0,2.5), col="black",#
     xlab="", ylab="", cex.axis=1, cex.lab=1, las=1,yaxt="n",xaxt="n")#
abline(h=1)#
abline(v=1)#
ifelse(i==2,axis(1),axis(1,labels=F))#
axis(2,las=2)#
box(col="grey")#
#
points(x=dat$S_Smsy_1980s, y=dat$U_Umsy_1980s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*5, pch=21, col="black")#
plot(x=dat$S_Smsy_2000s, y=dat$U_Umsy_2000s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*5, pch=21, xlim=c(0,4), ylim=c(0,2.5), col="black",#
     xlab="", ylab="", cex.axis=1, cex.lab=1, las=1,yaxt="n",xaxt="n")#
abline(h=1)#
abline(v=1)#
ifelse(i==2,axis(1),axis(1,labels=F))#
axis(2,labels=F)#
box(col="grey")#
#
text(x=rep(4.2,nrow(dat)), y=seq(0,2.5,length.out=nrow(dat)),#
     labels = dat$lake, pos=4, xpd=NA, cex=1, col=col.range[dat$alpha.order], font=2)#
#
for(j in 1:nrow(dat)) {#
  lines(x=c(dat$S_Smsy_2000s[j], 4.22),#
        y=c(dat$U_Umsy_2000s[j], seq(0,2.5,length.out=nrow(dat))[j]),#
        xpd=NA, col="light grey")  #
} #
#
points(x=dat$S_Smsy_2000s, y=dat$U_Umsy_2000s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*5, pch=21, col="black")#
}#
mtext(expression('U/U'[MSY]),2,line=1.5,outer=T)#
mtext(expression('S/S'[MSY]),1,line=1.5,outer=T)#
dev.off()
png("SuppMat_01.20.2020.png", width=5.5, height=6, units = "in", res = 500)#
par(mfrow=c(3,2))#
par(mar=c(1,1,1,1), oma=c(3,3,1,8))#
#
for(i in c(1,3,2)) {#
dat1 = all.dat[all.dat$system==systems[i],]#
#
dat <- dat1 %>% #
  arrange(desc(SAll))#
#
col.range <- colorRampPalette(c("red", "blue"))(nrow(dat))#
# col.range <- paste(col.range, "99", sep="")#
scaled.size <- sqrt(dat$SAll/max(dat$SAll))#
#
plot(x=dat$S_Smsy_1980s, y=dat$U_Umsy_1980s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*5, pch=21, xlim=c(0,4), ylim=c(0,2.5), col="black",#
     xlab="", ylab="", cex.axis=1, cex.lab=1, las=1,yaxt="n",xaxt="n")#
abline(h=1)#
abline(v=1)#
ifelse(i==2,axis(1),axis(1,labels=F))#
axis(2,las=2)#
box(col="grey")#
#
points(x=dat$S_Smsy_1980s, y=dat$U_Umsy_1980s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*5, pch=21, col="black")#
plot(x=dat$S_Smsy_2000s, y=dat$U_Umsy_2000s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*5, pch=21, xlim=c(0,4), ylim=c(0,2.5), col="black",#
     xlab="", ylab="", cex.axis=1, cex.lab=1, las=1,yaxt="n",xaxt="n")#
abline(h=1)#
abline(v=1)#
ifelse(i==2,axis(1),axis(1,labels=F))#
axis(2,labels=F)#
box(col="grey")#
#
text(x=rep(4.2,nrow(dat)), y=seq(0,2.5,length.out=nrow(dat)),#
     labels = dat$lake, pos=4, xpd=NA, cex=1, col=col.range[dat$alpha.order], font=2)#
#
for(j in 1:nrow(dat)) {#
  lines(x=c(dat$S_Smsy_2000s[j], 4.22),#
        y=c(dat$U_Umsy_2000s[j], seq(0,2.5,length.out=nrow(dat))[j]),#
        xpd=NA, col="light grey")  #
} #
#
points(x=dat$S_Smsy_2000s, y=dat$U_Umsy_2000s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*5, pch=21, col="black")#
}#
mtext(expression('U/U'[MSY]),2,line=1.5,outer=T)#
mtext(expression('S/S'[MSY]),1,line=1.5,outer=T)#
dev.off()
png("SuppMat_01.20.2020.png", width=5.5, height=6, units = "in", res = 500)#
par(mfrow=c(3,2))#
par(mar=c(1,1,1,1), oma=c(3,3,1,8))#
#
for(i in c(1,3,2)) {#
dat1 = all.dat[all.dat$system==systems[i],]#
#
dat <- dat1 %>% #
  arrange(desc(SAll))#
#
col.range <- colorRampPalette(c("red", "blue"))(nrow(dat))#
# col.range <- paste(col.range, "99", sep="")#
scaled.size <- sqrt(dat$SAll/max(dat$SAll))#
#
plot(x=dat$S_Smsy_1980s, y=dat$U_Umsy_1980s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*5, pch=21, xlim=c(0,4), ylim=c(0,2.5), col="black",#
     xlab="", ylab="", cex.axis=1, cex.lab=1, las=1,yaxt="n",xaxt="n")#
abline(h=1)#
abline(v=1)#
ifelse(i==2,axis(1),axis(1,labels=F))#
axis(2,las=2)#
box(col="grey")#
#
points(x=dat$S_Smsy_1980s, y=dat$U_Umsy_1980s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*5, pch=21, col="black")#
plot(x=dat$S_Smsy_2000s, y=dat$U_Umsy_2000s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*5, pch=21, xlim=c(0,4), ylim=c(0,2.5), col="black",#
     xlab="", ylab="", cex.axis=1, cex.lab=1, las=1,yaxt="n",xaxt="n")#
abline(h=1)#
abline(v=1)#
ifelse(i==2,axis(1),axis(1,labels=F))#
axis(2,labels=F)#
box(col="grey")#
#
text(x=rep(4.2,nrow(dat)), y=seq(0,2.25,length.out=nrow(dat)),#
     labels = dat$lake, pos=4, xpd=NA, cex=1, col=col.range[dat$alpha.order], font=2)#
#
for(j in 1:nrow(dat)) {#
  lines(x=c(dat$S_Smsy_2000s[j], 4.22),#
        y=c(dat$U_Umsy_2000s[j], seq(0,2.25,length.out=nrow(dat))[j]),#
        xpd=NA, col="light grey")  #
} #
#
points(x=dat$S_Smsy_2000s, y=dat$U_Umsy_2000s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*5, pch=21, col="black")#
}#
mtext(expression('U/U'[MSY]),2,line=1.5,outer=T)#
mtext(expression('S/S'[MSY]),1,line=1.5,outer=T)#
dev.off()
library(MASS)#
library(ggplot2)#
library(gridExtra)#
library(dplyr)
systems <- c("Bristol Bay", "Fraser", "Skeena")#
decades <- c("1970s", "1980s", "1990s", "2000s")#
System.all <- list()#
#
yr.range <- 10#
#
# error if Cultus lake is in the csv for alpha / beta parameters or if Skeena#
# has Azuklotz#
#
for(j in 1:length(systems)) {#
  temp.S <- read.csv(paste(systems[j], "_Smsy_", yr.range, "yrs.csv", sep=""), header=T)#
  colnames(temp.S) <- c("lake", "meanSmsy", "SlowerCI", "SupperCI",#
                        "S1970s", "S1980s", "S1990s", "S2000s", "SAll")#
  temp.U <- read.csv(paste(systems[j], "_Umsy_", yr.range, "yrs.csv", sep=""), header=T)#
  temp.params <- read.csv(paste(systems[j], "_AlphaBeta_estimates.csv", sep=""))#
  for(i in 1:length(decades)) {#
    S.msy.temp <- cbind(temp.S[(4+i)]/temp.S$meanSmsy,#
                        temp.S[(4+i)]/temp.S$SlowerCI,#
                        temp.S[(4+i)]/temp.S$SupperCI)#
    colnames(S.msy.temp) <- c(paste("S_Smsy_", decades[i], sep=""),#
                              paste("SLCL_", decades[i], sep=""),#
                              paste("SUCL_", decades[i], sep=""))#
    temp.S <- cbind(temp.S, S.msy.temp)#
    U.msy.temp <- cbind(temp.U[(4+i)]/temp.U$meanUmsy,#
                        temp.U[(4+i)]/(temp.U$lowerCI),#
                        temp.U[(4+i)]/(temp.U$upperCI))#
    colnames(U.msy.temp) <- c(paste("U_Umsy_", decades[i], sep=""),#
                              paste("ULCL_", decades[i], sep=""),#
                              paste("UUCL_", decades[i], sep=""))#
    temp.U <- cbind(temp.U, U.msy.temp)#
    sys.name <- rep(systems[j], nrow(temp.U))#
  }#
  if(j==2) {temp.params <- subset(temp.params, stock!="Cultus")}#
  if(j==3) {temp.params <- subset(temp.params, stock!="Azuklotz")}#
  alpha.order <- rank(temp.params$alpha)#
  System.all[[j]] <- cbind(system=sys.name, temp.S, temp.U, temp.params, #
                           alpha.order)#
}#
#
all.dat <- do.call(rbind.data.frame, System.all)
png("SuppMat_01.20.2020.png", width=5.5, height=6, units = "in", res = 500)#
par(mfrow=c(3,2))#
par(mar=c(1,1,1,1), oma=c(3,3,1,8))#
#
for(i in c(1,3,2)) {#
dat1 = all.dat[all.dat$system==systems[i],]#
#
dat <- dat1 %>% #
  arrange(desc(SAll))#
#
col.range <- colorRampPalette(c("red", "blue"))(nrow(16))#
# col.range <- paste(col.range, "99", sep="")#
scaled.size <- sqrt(dat$SAll/max(dat$SAll))#
#
plot(x=dat$S_Smsy_1980s, y=dat$U_Umsy_1980s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*5, pch=21, xlim=c(0,4), ylim=c(0,2.5), col="black",#
     xlab="", ylab="", cex.axis=1, cex.lab=1, las=1,yaxt="n",xaxt="n")#
abline(h=1)#
abline(v=1)#
ifelse(i==2,axis(1),axis(1,labels=F))#
axis(2,las=2)#
box(col="grey")#
#
points(x=dat$S_Smsy_1980s, y=dat$U_Umsy_1980s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*5, pch=21, col="black")#
plot(x=dat$S_Smsy_2000s, y=dat$U_Umsy_2000s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*5, pch=21, xlim=c(0,4), ylim=c(0,2.5), col="black",#
     xlab="", ylab="", cex.axis=1, cex.lab=1, las=1,yaxt="n",xaxt="n")#
abline(h=1)#
abline(v=1)#
ifelse(i==2,axis(1),axis(1,labels=F))#
axis(2,labels=F)#
box(col="grey")#
#
text(x=rep(4.2,nrow(dat)), y=seq(0,2.25,length.out=nrow(dat)),#
     labels = dat$lake, pos=4, xpd=NA, cex=1, col=col.range[dat$alpha.order], font=2)#
#
for(j in 1:nrow(dat)) {#
  lines(x=c(dat$S_Smsy_2000s[j], 4.22),#
        y=c(dat$U_Umsy_2000s[j], seq(0,2.25,length.out=nrow(dat))[j]),#
        xpd=NA, col="light grey")  #
} #
#
points(x=dat$S_Smsy_2000s, y=dat$U_Umsy_2000s, bg=col.range[dat$alpha.order], #
     cex= scaled.size*5, pch=21, col="black")#
}#
mtext(expression('U/U'[MSY]),2,line=1.5,outer=T)#
mtext(expression('S/S'[MSY]),1,line=1.5,outer=T)#
dev.off()
